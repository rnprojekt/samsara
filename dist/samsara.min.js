!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.Samsara=i():t.Samsara=i()}(this,function(){return function(t){function i(n){if(e[n])return e[n].exports;var s=e[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){var n;n=function(t,i,n){n.exports={Core:e(1),DOM:e(35),Events:e(42),Inputs:e(43),Layouts:e(53),Streams:e(63),Camera:e(64)}}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){n.exports={Engine:e(2),Timer:e(10),Transform:e(9),Transitionable:e(11),View:e(25)}}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(){h.push(o),h.push(r),isNaN(f)&&g.start()}function o(){var t=window.innerHeight,i=window.innerWidth;if(v){var e=t>i;if(y===e&&i===m)return!1;y=e,g.size.emit("start"),c.push(function(){g.size.emit("end","end")})}else{if(i===m&&t===_)return!1;m=i,_=t,b?u.push(function(){g.size.emit("update"),I()}):(g.size.emit("start"),b=!0,I())}}function r(){g.layout.trigger("start",x),c.push(function(){g.layout.trigger("end",x)})}var a=e(3),u=e(5),h=e(6),c=e(7),p=e(8),l=e(9),d=e(10),f=Number.NaN,v=/mobi/i.test(window.navigator.userAgent),y=Number.NaN,m=Number.NaN,_=Number.NaN;window.addEventListener("resize",o,!1);var g={};g.size=new a,g.layout=new a,g.step=function(){for(;h.length;)h.shift()();for(var t=0;t<p.length;t++)p[t]();for(;u.length;)u.shift()();for(;c.length;)c.shift()()},g.start=function t(){g.step(),f=window.requestAnimationFrame(t)},g.stop=function(){window.cancelAnimationFrame(f),f=Number.NaN},g.registerContext=function(t){t._size.subscribe(g.size),t._layout.subscribe(g.layout),window.Promise?window.Promise.resolve().then(s):window.requestAnimationFrame(s)},g.deregisterContext=function(t){t._size.unsubscribe(g.size),t._layout.unsubscribe(g.layout)};var b=!1,O=150,I=d.debounce(function(){c.push(function(){g.size.emit("end","end"),b=!1})},O),x={transform:l.identity,opacity:1,origin:null,align:null,nextSizeTransform:l.identity};n.exports=g}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(){o.apply(this,arguments),this.upstream=[],this.upstreamListeners={}}var o=e(4);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.setInputHandler=function(t,i){t.trigger=i.trigger.bind(i),t.subscribe=i.subscribe.bind(i),t.unsubscribe=i.unsubscribe.bind(i)},s.setOutputHandler=function(t,i){i.bindThis(t),t.emit=i.emit.bind(i),t.on=i.on.bind(i),t.off=i.off.bind(i)},s.prototype.on=function(t,i){if(o.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var e=this.trigger.bind(this,t);this.upstreamListeners[t]=e;for(var n=0;n<this.upstream.length;n++)this.upstream[n].on(t,e)}},s.prototype.off=function(t,i){var e=o.prototype.off.apply(this,arguments);if(e&&this.upstreamListeners[t]){var n=this.upstreamListeners[t];delete this.upstreamListeners[t];for(var s=0;s<this.upstream.length;s++)this.upstream[s].off(t,n)}},s.prototype.subscribe=function(t){var i=this.upstream.indexOf(t);if(i<0){this.upstream.push(t);for(var e in this.upstreamListeners)t.on(e,this.upstreamListeners[e])}return t},s.prototype.unsubscribe=function(t){if(t){var i=this.upstream.indexOf(t);if(i>=0){this.upstream.splice(i,1);for(var e in this.upstreamListeners)t.off(e,this.upstreamListeners[e])}}else for(var n=0;n<this.upstream.length;n++)this.unsubscribe(this.upstream[n])},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,e){function n(){this.listeners={},this._owner=this}n.prototype.emit=function(t,i){if(i!==!1){var e=this.listeners[t];if(e)for(var n=0;n<e.length;n++)e[n].call(this._owner,i)}},n.prototype.trigger=n.prototype.emit,n.prototype.on=function(t,i){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(i)},n.prototype.once=function(t,i){var e=function(){n.prototype.off.call(this._owner,t,e),i.apply(this._owner,arguments)}.bind(this);this.on(t,e)},n.prototype.off=function(t,i){if(!t)return this.listeners={},!0;var e=this.listeners[t];if(void 0!==e)if(i){var n=e.indexOf(i);n>=0&&e.splice(n,1)}else this.listeners[t]=[];return 0===this.listeners[t].length},n.prototype.bindThis=function(t){this._owner=t},e.exports=n}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,e){e.exports=[]}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,e){e.exports=[]}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,e){e.exports=[]}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,e){e.exports=[]}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,e){function n(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function s(t){return Math.sqrt(n(t))}function o(t){return t<0?-1:1}var r={};r.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,1.001,1],r.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-1.001,1],r.compose=function(t,i){return t===r.identity?i.slice():i===r.identity?t.slice():[t[0]*i[0]+t[4]*i[1]+t[8]*i[2],t[1]*i[0]+t[5]*i[1]+t[9]*i[2],t[2]*i[0]+t[6]*i[1]+t[10]*i[2],0,t[0]*i[4]+t[4]*i[5]+t[8]*i[6],t[1]*i[4]+t[5]*i[5]+t[9]*i[6],t[2]*i[4]+t[6]*i[5]+t[10]*i[6],0,t[0]*i[8]+t[4]*i[9]+t[8]*i[10],t[1]*i[8]+t[5]*i[9]+t[9]*i[10],t[2]*i[8]+t[6]*i[9]+t[10]*i[10],0,t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12],t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13],t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14],1]},r.composeMany=function(){if(arguments.length>2){var t=arguments[0],i=arguments[1];return Array.prototype.shift.call(arguments),arguments[0]=r.compose(t,i),r.composeMany.apply(null,arguments)}return r.compose.apply(null,arguments)},r.thenMove=function(t,i){return i[2]||(i[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+i[0],t[13]+i[1],t[14]+i[2],1]},r.moveThen=function(t,i){t[2]||(t[2]=0);var e=t[0]*i[0]+t[1]*i[4]+t[2]*i[8],n=t[0]*i[1]+t[1]*i[5]+t[2]*i[9],s=t[0]*i[2]+t[1]*i[6]+t[2]*i[10];return r.thenMove(i,[e,n,s])},r.translate=function(t){var i=t[0]||0,e=t[1]||0,n=t[2]||0;return[1,0,0,0,0,1,0,0,0,0,1,0,i,e,n,1]},r.translateX=function(t){return[1,0,0,0,0,1,0,0,0,0,1,0,t,0,0,1]},r.translateY=function(t){return[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1]},r.translateZ=function(t){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,t,1]},r.scale=function(t){var i=void 0!==t[0]?t[0]:1,e=void 0!==t[1]?t[1]:1,n=void 0!==t[2]?t[2]:1;return[i,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1]},r.scaleX=function(t){return[t,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},r.scaleY=function(t){return[1,0,0,0,0,t,0,0,0,0,1,0,0,0,0,1]},r.scaleZ=function(t){return[1,0,0,0,0,1,0,0,0,0,t,0,0,0,0,1]},r.thenScale=function(t,i){var e=void 0!==i[0]?i[0]:1,n=void 0!==i[1]?i[1]:1,s=void 0!==i[2]?i[2]:1;return[e*t[0],n*t[1],s*t[2],0,e*t[4],n*t[5],s*t[6],0,e*t[8],n*t[9],s*t[10],0,e*t[12],n*t[13],s*t[14],1]},r.rotateX=function(t){var i=Math.cos(t),e=Math.sin(t);return[1,0,0,0,0,i,e,0,0,-e,i,0,0,0,0,1]},r.rotateY=function(t){var i=Math.cos(t),e=Math.sin(t);return[i,0,-e,0,0,1,0,0,e,0,i,0,0,0,0,1]},r.rotateZ=function(t){var i=Math.cos(t),e=Math.sin(t);return[i,e,0,0,-e,i,0,0,0,0,1,0,0,0,0,1]},r.skewX=function(t){return[1,0,0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},r.skewY=function(t){return[1,Math.tan(t),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},r.rotateAxis=function(t,i){var e=Math.sin(i),n=1-Math.cos(i),s=1-n,o=t[0]*t[0]*s,r=t[0]*t[1]*s,a=t[0]*t[2]*s,u=t[1]*t[1]*s,h=t[1]*t[2]*s,c=t[2]*t[2]*s,p=t[0]*e,l=t[1]*e,d=t[2]*e;return[o+n,r+d,a-l,0,r-d,u+n,h+p,0,a+l,h-p,c+n,0,0,0,0,1]},r.aboutOrigin=function(t,i){t[2]=t[2]||0;var e=t[0]-(t[0]*i[0]+t[1]*i[4]+t[2]*i[8]),n=t[1]-(t[0]*i[1]+t[1]*i[5]+t[2]*i[9]),s=t[2]-(t[0]*i[2]+t[1]*i[6]+t[2]*i[10]);return r.thenMove(i,[e,n,s])},r.getTranslate=function(t){return[t[12],t[13],t[14]]},r.inverse=function(t){var i=t[5]*t[10]-t[6]*t[9],e=t[4]*t[10]-t[6]*t[8],n=t[4]*t[9]-t[5]*t[8],s=t[1]*t[10]-t[2]*t[9],o=t[0]*t[10]-t[2]*t[8],r=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],u=t[0]*t[6]-t[2]*t[4],h=t[0]*t[5]-t[1]*t[4],c=t[0]*i-t[1]*e+t[2]*n,p=1/c,l=[p*i,-p*s,p*a,0,-p*e,p*o,-p*u,0,p*n,-p*r,p*h,0,0,0,0,1];return l[12]=-t[12]*l[0]-t[13]*l[4]-t[14]*l[8],l[13]=-t[12]*l[1]-t[13]*l[5]-t[14]*l[9],l[14]=-t[12]*l[2]-t[13]*l[6]-t[14]*l[10],l},r.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},r.interpret=function(t){var i=[t[0],t[1],t[2]],e=o(i[0]),a=s(i),u=[i[0]+e*a,i[1],i[2]],h=2/n(u);if(h>=1/0)return{translate:r.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];c[0]=1-h*u[0]*u[0],c[5]=1-h*u[1]*u[1],c[10]=1-h*u[2]*u[2],c[1]=-h*u[0]*u[1],c[2]=-h*u[0]*u[2],c[6]=-h*u[1]*u[2],c[4]=c[1],c[8]=c[2],c[9]=c[6];var p=r.compose(c,t),l=[p[5],p[6]],d=o(l[0]),f=s(l),v=[l[0]+d*f,l[1]],y=2/n(v),m=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];m[5]=1-y*v[0]*v[0],m[10]=1-y*v[1]*v[1],m[6]=-y*v[0]*v[1],m[9]=m[6];var _=r.compose(m,c),g=r.compose(_,t),b=r.scale([g[0]<0?-1:1,g[5]<0?-1:1,g[10]<0?-1:1]);g=r.compose(g,b),_=r.compose(b,_);var O={};return O.translate=r.getTranslate(t),O.rotate=[Math.atan2(-_[6],_[10]),Math.asin(_[2]),Math.atan2(-_[1],_[0])],O.rotate[0]||(O.rotate[0]=0,O.rotate[2]=Math.atan2(_[4],_[5])),O.scale=[g[0],g[5],g[10]],O.skew=[Math.atan2(g[9],O.scale[2]),Math.atan2(g[8],O.scale[2]),Math.atan2(g[4],O.scale[0])],Math.abs(O.rotate[0])+Math.abs(O.rotate[2])>1.5*Math.PI&&(O.rotate[1]=Math.PI-O.rotate[1],O.rotate[1]>Math.PI?O.rotate[1]-=2*Math.PI:O.rotate[1]<-Math.PI&&(O.rotate[1]+=2*Math.PI),O.rotate[0]<0?O.rotate[0]+=Math.PI:O.rotate[0]-=Math.PI,O.rotate[2]<0?O.rotate[2]+=Math.PI:O.rotate[2]-=Math.PI),O},r.build=function(t){var i=r.scale(t.scale[0],t.scale[1],t.scale[2]),e=r.skew(t.skew[0],t.skew[1],t.skew[2]),n=r.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return r.thenMove(r.compose(r.compose(n,e),i),t.translate)},r.average=function(t,i,e){e=void 0===e?.5:e;for(var n=r.interpret(t),s=r.interpret(i),o={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;a<3;a++)o.translate[a]=(1-e)*n.translate[a]+e*s.translate[a],o.rotate[a]=(1-e)*n.rotate[a]+e*s.rotate[a],o.scale[a]=(1-e)*n.scale[a]+e*s.scale[a],o.skew[a]=(1-e)*n.skew[a]+e*s.skew[a];return r.build(o)},r.equals=function(t,i){return!r.notEquals(t,i)},r.notEquals=function(t,i){return t!==i&&(!(t&&i)||t[12]!==i[12]||t[13]!==i[13]||t[14]!==i[14]||t[0]!==i[0]||t[1]!==i[1]||t[2]!==i[2]||t[4]!==i[4]||t[5]!==i[5]||t[6]!==i[6]||t[8]!==i[8]||t[9]!==i[9]||t[10]!==i[10])},e.exports=r}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){return r.push(t),t}function o(t){var i=r.indexOf(t);i!==-1&&r.splice(i,1)}var r=e(8),a={},u=window.performance?function(){return window.performance.now()}:Date.now;a.setTimeout=function(t,i){function e(){var s=u();s-n>=i&&(t.apply(this,arguments),a.clear(e))}var n=u();return s(e)},a.setInterval=function(t,i){function e(){var e=u();e-n>=i&&(t.apply(this,arguments),n=u())}var n=u();return s(e)},a.after=function(t,i){function e(){i--,i<=0&&(t.apply(this,arguments),a.clear(e))}if(void 0!==i)return s(e)},a.every=function(t,i){function e(){i--,i<=0&&(t.apply(this,arguments),i=n)}i=i||1;var n=i;return s(e)},a.clear=function(t){o(t)},a.debounce=function(t,i){var e;return function(){var n=arguments,s=function(){a.clear(e),e=null,t.apply(this,n)}.bind(this);e&&a.clear(e),e=a.setTimeout(s,i)}},a.frameDebounce=function(t,i){var e;return function(){var n=arguments,s=function(){e=null,t.apply(this,n)}.bind(this);e&&a.clear(e),e=a.after(s,i)}},n.exports=a}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this._callback=void 0,this._method=null,this._active=!1,this._currentActive=!1,this.updateMethod=void 0,this._eventInput=new h,this._eventOutput=new h,h.setInputHandler(this,this._eventInput),h.setOutputHandler(this,this._eventOutput);var i=!1;this._eventInput.on("start",function(t){i=!1,this._currentActive=!0,this._active||(this.emit("start",t),this._active=!0)}.bind(this)),this._eventInput.on("update",function(t){i=!0,this.emit("update",t)}.bind(this)),this._eventInput.on("end",function(t){if(this._currentActive=!1,this._callback){var e=this._callback;this._callback=void 0,e()}this._currentActive||(i=!1,this._active=!1,this.emit("end",t))}.bind(this)),void 0!==t&&(this.value=t,r.push(function(){this.trigger("start",t),a.push(function(){i||this.trigger("end",t)}.bind(this))}.bind(this)))}function o(t,i){this._eventOutput=new h,h.setOutputHandler(this,this._eventOutput),this.sources=[];for(var e=0;e<t.length;e++){var n=new i(t[e]);this.sources.push(n)}this.stream=p.merge(this.sources),this._eventOutput.subscribe(this.stream)}var r=e(6),a=e(7),u=e(8),h=e(3),c=e(12),p=e(16),l=e(19),d=e(21),f=e(22),v=e(23),y=e(24),m={tween:l,spring:d,inertia:f,damp:v};s.prototype=Object.create(c.prototype),s.prototype.constructor=s,s.register=function(t,i){t in m||(m[t]=i)},s.unregister=function(t){return t in m&&(delete m[t],!0)},s.prototype.set=function(t,i,e){var n;if(i&&0!==i.duration){e&&(this._callback=e);var s=i.curve;n=s&&m[s]?m[s]:l}else this.value=t,e&&a.push(e),n=y;if(this._method!==n){if(this._interpolant){if(this.updateMethod){var r=u.indexOf(this.updateMethod);r>=0&&u.splice(r,1)}this.unsubscribe(this._interpolant)}t instanceof Array?this._interpolant=t.length<n.DIMENSIONS?new n(this.get()):new o(this.get(),n):this._interpolant=new n(this.get()),this.subscribe(this._interpolant),this._interpolant.update&&(this.updateMethod=this._interpolant.update.bind(this._interpolant),u.push(this.updateMethod)),this._method=n}this._interpolant.set(t,i)},s.prototype.get=function(){return this._interpolant?this._interpolant.get():this.value},s.prototype.getVelocity=function(){if(this._interpolant&&this._interpolant.getVelocity)return this._interpolant.getVelocity()},s.prototype.reset=function(t,i){this._callback=null,this._method=null,this.value=t,this._interpolant&&this._interpolant.reset(t,i)},s.prototype.halt=function(){if(this._active){var t=this.get();if(this.reset(t),this.trigger("end",t),this._interpolant){if(this.updateMethod){var i=u.indexOf(this.updateMethod);i>=0&&u.splice(i,1)}this.unsubscribe(this._interpolant)}}},s.prototype.isActive=function(){return this._active},s.prototype.setMany=function(t,i){var e=t.shift();0===t.length?this.set(e[0],e[1],i):this.set(e[0],e[1],this.setMany.bind(this,t,i))},s.prototype.loop=function(t){var i=t.slice(0);this.setMany(t,this.loop.bind(this,i))},s.prototype.delay=function(t,i){this.set(this.get(),{duration:i,curve:function(){return 0}},t)},o.prototype.set=function(t,i){for(var e=i&&i.velocity?i.velocity.slice():void 0,n=0;n<t.length;n++)e&&(i.velocity=e[n]),this.sources[n].set(t[n],i)},o.prototype.get=function(){return this.sources.map(function(t){return t.get()})},o.prototype.getVelocity=function(){return this.sources.map(function(t){return t.getVelocity()})},o.prototype.update=function(){for(var t=0;t<this.sources.length;t++)this.sources[t].update()},o.prototype.reset=function(t){for(var i=0;i<this.sources.length;i++){var e=this.sources[i];e.reset(t[i])}},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(){o.call(this)}var o=e(3),r=e(13),a=e(14),u=e(15);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.map=function(t){var i=new s,e=new r(t);return i.subscribe(e).subscribe(this),i},s.prototype.filter=function t(i){var t=new a(i),e=new s;return e.subscribe(t).subscribe(this),e},s.prototype.split=function(t){var i=new u(t);i.subscribe(this)},s.prototype.pluck=function(t){return this.map(function(i){return i[t]})},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){o.call(this),this._mappingFunction=t}var o=e(3);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.emit=function(t,i){var e=this._mappingFunction(i);o.prototype.emit.call(this,t,e)},s.prototype.trigger=s.prototype.emit,n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){o.call(this),this._condition=t}var o=e(3);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.emit=function(t,i){this._condition(i)&&o.prototype.emit.apply(this,arguments)},s.prototype.trigger=s.prototype.emit,n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){o.call(this),this._splitter=t,this.on("start",function(){}),this.on("update",function(){}),this.on("end",function(){})}var o=e(3);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.emit=function(t,i){var e=this._splitter.call(this,i);e&&e.emit instanceof Function&&e.emit(t,i)},s.prototype.trigger=s.prototype.emit,n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){function i(i){var e=t&&t.start?t.start(i):i;e!==!1&&this.emit(l.START,e),r=!1}function e(i){var e=t&&t.update?t.update(i):i;e!==!1&&this.emit(l.UPDATE,e),u=!1}function n(i){var e=t&&t.end?t.end(i):i;e!==!1&&this.emit(l.END,e),d=!1}this._eventInput=new a,this._eventOutput=new a,a.setInputHandler(this,this._eventInput),a.setOutputHandler(this,this._eventOutput);var s=0,o=!1,r=!1,u=!1,d=!1;this._eventInput.on(l.START,function(t){return s++,!r&&!o&&(r=!0,void h.push(i.bind(this,t)))}.bind(this)),this._eventInput.on(l.UPDATE,function(t){return o=!0,!u&&(u=!0,void c.push(e.bind(this,t)))}.bind(this)),this._eventInput.on(l.END,function(t){return s--,o&&s>0?(e.call(this,t),!1):(o=!1,void(d||(d=!0,p.push(n.bind(this,t)))))}.bind(this))}var o=e(17),r=e(18),a=e(3),u=e(12),h=e(6),c=e(5),p=e(7),l={START:"start",UPDATE:"update",END:"end"};s.prototype=Object.create(u.prototype),s.prototype.constructor=s,s.merge=function(t){return new o(t)},s.lift=function(t,i){return new r(t,new o(i))},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.mergedData=t instanceof Array?[]:{},this.streamCache={};var i=e(16);i.call(this,{start:function(){return this.mergedData}.bind(this),update:function(){return this.mergedData}.bind(this),end:function(){return this.mergedData}.bind(this)});for(var n in t)this.addStream(n,t[n])}var o=e(12);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.addStream=function(t,i){var e=this.mergedData;i instanceof Object&&i.on?(e[t]=void 0,i.on("start",function(i){e[t]=i}),i.on("update",function(i){e[t]=i}),i.on("end",function(i){e[t]=i}),this.subscribe(i)):e[t]=i,this.streamCache[t]=i},s.prototype.removeStream=function(t){var i=this.streamCache[t];if(this.unsubscribe(i),delete this.streamCache[t],this.mergedData instanceof Array){var e=this.mergedData.indexOf(t);this.mergedData.splice(e,1)}else delete this.mergedData[t]},s.prototype.replaceStream=function(t,i){this.removeStream(t),this.addStream(t,i)},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t,i){o.call(this);var e=new r(function(i){return t.apply(null,i)});this.mergedStream=i,this.subscribe(e).subscribe(i)}var o=e(12),r=e(13);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.replaceStream=function(){this.mergedStream.replaceStream.apply(this.mergedStream,arguments)},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){c.apply(this,arguments),this._curve=void 0,this._duration=0}function o(t){var i=f[t];if(void 0!==i)return i;throw new Error("curve not registered")}function r(t,i,e){var n;if(t instanceof Array){n=[];for(var s=0;s<t.length;s++)"number"==typeof t[s]?n.push(a(t[s],i[s],e)):n.push(t[s])}else n=a(t,i,e);return n}function a(t,i,e){return(1-e)*t+e*i}function u(t,i,e,n,s){return(t-i)*(e(s+d)-e(s-d))/(2*d*n)}function h(t,i,e,n,s){var o;if(t instanceof Array){o=[];for(var r=0;r<t.length;r++)"number"==typeof t[r]?o.push(u(t[r],i[r],e,n,s)):o.push(t[r])}else o=u(t,i,e,n,s);return o}var c=e(20),p=e(7),l=Date.now,d=1e-9,f={};s.prototype=Object.create(c.prototype),s.prototype.constructor=s,s.CURVES={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return t<=.5?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1+Math.pow(t-1,3)},easeInOutCubic:function(t){return t*=2,t<1?.5*t*t*t:.5*Math.pow(t-2,3)+1},easeOutWall:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},s.DIMENSIONS=1/0,s.DEFAULT_OPTIONS={curve:s.CURVES.linear,duration:500},s.register=function(t,i){return!f[t]&&(f[t]=i,!0)},s.deregister=function(t){return!!f[t]&&(delete f[t],!0)},s.getCurves=function(){return f},s.prototype.set=function(t,i){c.prototype.set.apply(this,arguments);var e=i.curve;!f[e]&&s.CURVES[e]&&s.register(e,s.CURVES[e]),this._duration=i.duration||s.DEFAULT_OPTIONS.duration,this._curve=e?e instanceof Function?e:o(e):s.DEFAULT_OPTIONS.curve},s.prototype.update=function(){if(this._active){var t=l()-this._previousTime;if(this.velocity=h(this.state,this.start,this._curve,this._duration,1),t<this._duration){var i=t/this._duration;this.value=r(this.start,this.end,this._curve(i)),this.emit("update",this.value)}else this.emit("update",this.end),p.push(function(){this.reset(this.end),this._active=!1,this.emit("end",this.end)}.bind(this))}},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t,i){r.call(this),this.value=t||0,this.velocity=i||0,this.start=t,this.end=0,this.energy=Number.NaN,this._previousTime=Number.NaN,this._active=!1,this._eventOutput=new o,o.setOutputHandler(this,this._eventOutput)}var o=e(3),r=e(12);s.DIMENSIONS=1,s.DEFAULT_OPTIONS={},s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.prototype.set=function(t,i){this._active||(this.emit("start",this.get()),this._active=!0),this.start=this.get(),this.end=t,i&&i.velocity?this.velocity=i.velocity:this.velocity=this.velocity||0,this._previousTime=Date.now()},s.prototype.get=function(){return this.value},s.prototype.getVelocity=function(){return this.velocity},s.prototype.reset=function(t,i){this.start=t,this.value=t,this.velocity=i||0},s.prototype.halt=function(){if(this._active){this._active=!1;var t=this.get();this.reset(t),this.emit("end",t)}},s.prototype.isActive=function(){return this._active},s.prototype.update=function(){},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t,i){p.apply(this,arguments),this.curve=null,this.energyTolerance=v}function o(t,i){return Math.max(1,Math.abs(i-t))}function r(t,i,e,n,s){return t<1?u(t,i,e,n,s):1===t?h(t,i,e,n,s):c(t,i,e,n,s)}function a(t){var i=2*Math.PI/t;return function(t,e,n){var s=t-e,o=i*i*s*s,r=n*n;return r+o}}function u(t,i,e,n,s){var o=Math.sqrt(1-t*t)/i,r=e-n,a=(t/i*r+s)/o;return function(e){return n+Math.exp(-t*e/i)*(r*Math.cos(o*e)+a*Math.sin(o*e))}}function h(t,i,e,n,s){var o=e-n,r=s+o/i;return function(e){return n+Math.exp(-t*e/i)*(o+r*e)}}function c(t,i,e,n,s){var o=Math.sqrt(t*t-1)/i,r=-t/i+o,a=-t/i-o,u=e-n,h=(r*u-s)/(a-r),c=u+h,p=-h;return function(t){return n+c*Math.exp(r*t)+p*Math.exp(a*t)}}var p=e(20),l=e(7),d=Date.now,f=1e-6,v=1e-9;s.DIMENSIONS=1,s.DEFAULT_OPTIONS={velocity:0,damping:.5,period:100},s.prototype=Object.create(p.prototype),s.prototype.constructor=s,s.prototype.set=function(t,i){p.prototype.set.apply(this,arguments);var e=i.damping||s.DEFAULT_OPTIONS.damping,n=i.period||s.DEFAULT_OPTIONS.period;this.curve=r(e,n,this.start,this.end,this.velocity),this.energy=a(n);var u=o(this.end,this.start);this.energyTolerance=v*Math.pow(u,2)},s.prototype.update=function(){if(this._active){var t=d()-this._previousTime;this.value=this.curve(t);var i=this.curve(t+f),e=this.curve(t-f);this.velocity=(i-e)/(2*f);var n=this.energy(this.end,this.value,this.velocity);n>=this.energyTolerance?this.emit("update",this.value):(this.emit("update",this.end),l.push(function(){this.reset(this.end),this._active=!1,this.emit("end",this.end)}.bind(this)))}},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t,i){o.apply(this,arguments),this.drag=0}var o=e(20),r=e(7),a=Date.now,u=1e-4;s.DIMENSIONS=1,s.DEFAULT_OPTIONS={velocity:0,drag:.1},s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.set=function(t,i){o.prototype.set.apply(this,arguments),this.drag=void 0===i.drag?s.DEFAULT_OPTIONS.drag:Math.pow(Math.min(i.drag,1),3)},s.prototype.update=function(){if(this._active){var t=a(),i=t-this._previousTime;this._previousTime=t,this.velocity*=1-this.drag,this.value+=i*this.velocity;var e=.5*this.velocity*this.velocity;e>=u?this.emit("update",this.value):(this.emit("update",this.value),r.push(function(){this.reset(this.value),this._active=!1,this.emit("end",this.value)}.bind(this)))}},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t,i){o.apply(this,arguments),this.damp=0}var o=e(20),r=e(7),a=Date.now,u=1e-6;s.DIMENSIONS=1,s.DEFAULT_OPTIONS={damping:.9},s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.set=function(t,i){o.prototype.set.apply(this,arguments),this.damp=void 0===i.damping?s.DEFAULT_OPTIONS.damping:i.damping},s.prototype.update=function(){if(this._active){var t=a(),i=t-this._previousTime;this._previousTime=t;var e=this.value*this.damp;this.velocity=1/i*(this.value-e),this.value=e;var n=.5*this.value*this.value;n>=u?this.emit("update",this.value):(this.emit("update",this.value),r.push(function(){this.reset(this.value),this._active=!1,this.emit("end",this.value)}.bind(this)))}},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){o.apply(this,arguments)}var o=e(20),r=e(7);s.DIMENSIONS=1/0,s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.set=function(t){this.value=t,o.prototype.set.apply(this,arguments),r.push(function(){this.emit("end",this.value)}.bind(this))},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this._cachedSize[0]===t[0]&&this._cachedSize[1]===t[1]||(this._cachedSize=t,this.emit("resize",t))}function o(t){for(var i in t){var e=t[i];switch(i){case"size":this.setSize(e);break;case"proportions":this.setProportions(e);break;case"margins":this.setMargins(e);break;case"aspectRatio":this.setAspectRatio(e);break;case"origin":this.setOrigin(e);break;case"opacity":this.setOpacity(e)}}}var r=e(26),a=e(28),u=e(32),h=e(29),c=r.extend({defaults:{size:null,origin:null,opacity:1},events:{change:o},constructor:function(t){this._sizeNode=new u,this._layoutNode=new h,this._node=new a,this._addNode=this._node.add(this._sizeNode).add(this._layoutNode),this.size=this._addNode.size,this._size=this._node.size,this._cachedSize=[0,0],this.size.on("start",s.bind(this)),this.size.on("update",s.bind(this)),this.size.on("end",s.bind(this)),r.call(this,t),this.options&&o.call(this,this.options)},_onAdd:function(t){return t.add(this._node)},add:function(){return a.prototype.add.apply(this._addNode,arguments)},remove:function(){a.prototype.remove.apply(this._node,arguments)},getSize:function(){return this._cachedSize},setSize:function(t){this._cachedSize=t,this._sizeNode.set({size:t})},setProportions:function(t){this._sizeNode.set({proportions:t})},setMargins:function(t){this._sizeNode.set({margins:t})},setAspectRatio:function(t){this._sizeNode.set({aspectRatio:t})},setOrigin:function(t){this._layoutNode.set({origin:t})},setOpacity:function(t){this._layoutNode.set({opacity:t})}});n.exports=c}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=o(this.constructor.DEFAULT_OPTIONS||s.DEFAULT_OPTIONS),this._optionsManager=new u(this.options),t&&this.setOptions(t),this.input=new c,this.output=new c,h.setInputHandler(this,this.input),h.setOutputHandler(this,this.output),r.call(this,this.constructor.EVENTS||s.EVENTS,this.input),this.input.bindThis(this),this.input.subscribe(this._optionsManager),this.initialize&&this.initialize(this.options)}function o(t){var i;if("object"==typeof t){i=t instanceof Array?[]:{};for(var e in t){var n=t[e];if("object"==typeof n&&null!==n)if(n instanceof Array){i[e]=[];for(var s=0;s<n.length;s++)i[e][s]=o(n[s])}else i[e]=o(n);else i[e]=n}}else i=t;return i}function r(t,i){for(var e in t){var n=t[e],s="string"==typeof n?this[n]:n;s&&i.on(e,s.bind(this))}}function a(t,i){var e=this,n=t.hasOwnProperty("constructor")?function(){t.constructor.apply(this,arguments)}:function(){e.apply(this,arguments)};n.extend=a,n.prototype=Object.create(e.prototype),n.prototype.constructor=n;for(var s in t){var o=t[s];switch(s){case p.DEFAULTS:n.DEFAULT_OPTIONS=o;break;case p.EVENTS:if(n.EVENTS)for(var r in o)n.EVENTS[r]=o[r];else n.EVENTS=o;break;default:n.prototype[s]=o}}for(s in i)n[s]=i[s];return n}var u=e(27),h=e(3),c=e(12);s.DEFAULT_OPTIONS={},s.EVENTS={},s.prototype.getOptions=function(t){return u.prototype.getOptions.apply(this._optionsManager,arguments)},s.prototype.setOptions=function(){u.prototype.setOptions.apply(this._optionsManager,arguments)};var p={DEFAULTS:"defaults",EVENTS:"events"};s.extend=a,n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this._value=t,this._eventHandler=null}function o(){this._eventHandler||(this._eventHandler=new a)}function r(t){var i;if("object"==typeof t){i=t instanceof Array?[]:{};for(var e in t){var n=t[e];if("object"==typeof n&&null!==n)if(n instanceof Array){i[e]=[];for(var s=0;s<n.length;s++)i[e][s]=r(n[s])}else i[e]=r(n);else i[e]=n}}else i=t;return i}var a=e(3);s.patch=function(t,i){for(var e=new s(t),n=1;n<arguments.length;n++)e.patch(arguments[n]);return t},s.setOptions=function(t,i,e){e=e||r(t.constructor.DEFAULT_OPTIONS)||{};var n=new s(e);return t.setOptions=s.prototype.setOptions.bind(n),t.getOptions=s.prototype.getOptions.bind(n),i&&t.setOptions(i),n.get()},s.prototype.patch=function(t){var i=this._value;for(var e in t)e in i&&t[e]&&t[e].constructor===Object&&i[e]&&i[e].constructor===Object?(i.hasOwnProperty(e)||(i[e]=Object.create(i[e])),this.key(e).patch(t[e]),this._eventHandler&&this._eventHandler.emit("change",{key:e,value:this.key(e).value()})):this.set(e,t[e]);return this},s.prototype.setOptions=s.prototype.patch,s.prototype.key=function t(t){var i=new s(this._value[t]);return i._value instanceof Object&&!(i._value instanceof Array)||(i._value={}),i},s.prototype.get=function(t){return t?this._value[t]:this._value},s.prototype.getOptions=s.prototype.get,s.prototype.set=function(t,i){var e=this.get(t);return this._value[t]=i,this._eventHandler&&i!==e&&this._eventHandler.emit("change",{key:t,value:i}),this},s.prototype.on=function(t,i){o.call(this),a.prototype.on.apply(this._eventHandler,arguments)},s.prototype.off=function(t,i){o.call(this),a.prototype.off.apply(this._eventHandler,arguments)},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this._layout=new h,this._size=new h,this._logic=new h,this.size=new c,this.layout=new c,t?u.call(this,t):(this.layout.subscribe(this._layout),this.size.subscribe(this._size)),this._cachedSpec={layout:null,size:null},this.size.on("start",r.bind(this)),this.size.on("update",r.bind(this)),this.size.on("end",r.bind(this)),this.layout.on("start",o.bind(this)),this.layout.on("update",o.bind(this)),this.layout.on("end",o.bind(this)),this.root=null,this._logic.on("mount",function(t){this.root=t}.bind(this)),this._logic.on("unmount",function(){this.root=null}.bind(this))}function o(t){this._cachedSpec.layout=t;
}function r(t){this._cachedSpec.size=t}function a(t){var i={},e={},n=!1,s=!1,o=this;for(var r in t)d.KEYS[r]?(i[r]=t[r],n=!0):l.KEYS[r]&&(e[r]=t[r],s=!0);if(n&&e.align){var a=new l({align:e.align});delete e.align,o=o.add(a)}return n&&(o=o.add(new d(i))),s&&(o=o.add(new l(e))),o}function u(t){if(t instanceof d){var i=p.lift(function(t,i){return!!i&&(t?v(t,i):i)}.bind(this),[t,this._size]);this.size.subscribe(i),this.layout.subscribe(this._layout)}else if(t instanceof l){var e=p.lift(function(t,i,e){return!(!i||!e)&&(t?f(t,i,e):i)}.bind(this),[t,this._layout,this._size]);this.layout.subscribe(e),this.size.subscribe(this._size)}else this._logic.on("unmount",function(){t.remove()}.bind(this)),this._logic.on("mount",function(i){t.setup(i.allocator)}.bind(this)),t.on("recall",function(){t._size.unsubscribe(this._size),t._layout.unsubscribe(this._layout)}.bind(this)),t.on("deploy",function(){t._size.subscribe(this._size),t._layout.subscribe(this._layout)}.bind(this))}var h=e(3),c=e(12),p=e(16),l=e(29),d=e(32),f=e(33),v=e(34),y=e(6),m=e(7);s.prototype.add=function(t){var i;if(t.constructor===Object)return a.call(this,t);if(t._onAdd)return t._onAdd(this);if(i=t instanceof s?t:new s(t),i._layout.subscribe(this.layout),i._size.subscribe(this.size),i._logic.subscribe(this._logic),this.root&&!i.root&&i._logic.trigger("mount",this.root),!t.root){var e=this;y.push(function(){e._cachedSpec.size&&(e.size.trigger("start",e._cachedSpec.size),e.layout.trigger("start",e._cachedSpec.layout),m.push(function(){e.size.trigger("end",e._cachedSpec.size),e.layout.trigger("end",e._cachedSpec.layout)}))})}return i},s.prototype.remove=function(){this._logic.trigger("unmount"),this._layout.unsubscribe(),this._size.unsubscribe(),this._logic.unsubscribe()},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){o.call(this,t)}var o=e(30);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.KEYS={transform:!0,origin:!0,align:!0,opacity:!0},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.stream=o(t),r.setOutputHandler(this,this.stream)}function o(t){for(var i in t){var e=t[i];if(!(e instanceof a)){var n=new h(e);t[i]=n}}return u.merge(t)}var r=e(3),a=e(12),u=e(16),h=e(31);s.prototype.set=function(t){for(var i in t){var e=t[i],n=e instanceof a?e:new h(e);this.stream.addStream(i,n)}},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){o.call(this),this.value=t,void 0!==t&&this.set(t)}var o=e(12),r=e(6),a=e(7);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.get=function(){return this.value},s.prototype.set=function(t){var i=this;i.value=t,r.push(function(){i.emit("start",t),a.push(function(){i.emit("end",t)})})},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){o.call(this,t)}var o=e(30);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.KEYS={size:!0,proportions:!0,margins:!0,aspectRatio:!0},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t,i,e){var n=void 0!==i.opacity?i.opacity:a.OPACITY,s=i.transform||a.TRANSFORM,u=t.origin||a.ORIGIN,h=t.align||a.ALIGN,c=void 0!==t.opacity?n*t.opacity:n,p=t.transform?r.compose(s,t.transform):s,l=t.origin?s:i.nextSizeTransform||s;if(t.size&&(l=s),u&&(u[0]||u[1])){var d="number"==typeof e[0]?-u[0]*e[0]:0,f="number"==typeof e[1]?-u[1]*e[1]:0;p=r.moveThen([d,f,0],p),u=null}if(e&&h&&(h[0]||h[1])){var v=o([h[0]*e[0],h[1]*e[1],0],l);p=r.thenMove(p,v),h=null}return{transform:p,opacity:c,origin:u,align:h,nextSizeTransform:l}}function o(t,i){return[t[0]*i[0]+t[1]*i[4]+t[2]*i[8],t[0]*i[1]+t[1]*i[5]+t[2]*i[9],t[0]*i[2]+t[1]*i[6]+t[2]*i[10]]}var r=e(9),a={OPACITY:1,TRANSFORM:r.identity,ORIGIN:null,ALIGN:null};n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,e){function n(t,i){if(!t)return i;var e=new Array(2);return t.size instanceof Function?e=t.size(i):t.size instanceof Array&&(void 0===t.size[0]&&(e[0]=i[0]),void 0===t.size[1]&&(e[1]=i[1]),"number"==typeof t.size[0]&&(e[0]=t.size[0]),"number"==typeof t.size[1]&&(e[1]=t.size[1]),t.size[0]===!0&&(e[0]=!0),t.size[1]===!0&&(e[1]=!0)),t.proportions&&("number"==typeof t.proportions[0]&&(e[0]=t.proportions[0]*i[0]),"number"==typeof t.proportions[1]&&(e[1]=t.proportions[1]*i[1])),t.aspectRatio&&("number"==typeof e[0]?e[1]=t.aspectRatio*e[0]:"number"==typeof e[1]&&(e[0]=t.aspectRatio*e[1])),void 0===e[0]&&(e[0]=i[0]),void 0===e[1]&&(e[1]=i[1]),t.margins&&(e[0]-=2*t.margins[0],e[1]-=2*t.margins[1]),e}e.exports=n}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){n.exports={Surface:e(36),ContainerSurface:e(38),Context:e(39)}}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){function i(t){var i=t.type;return"touchstart"===i&&(e=!0),!e||"m"!==i[0]||("mouseup"===i&&(e=!1),!1)}this.properties={},this.attributes={},this.classList=[],this.content="",this._cachedSpec={},this._allocator=null,this._currentTarget=null,this._elementOutput=new a,this._eventOutput=new u,u.setOutputHandler(this,this._eventOutput),this._eventForwarder=function(t){t.stopPropagation();var e=i.call(this,t);e&&this._eventOutput.emit(t.type,t)}.bind(this);var e=!1;this._sizeNode=new c,this._layoutNode=new p,this._size=new u,this._layout=new u,this.size=h.lift(function(t,i){return!!i&&l(t,i)},[this._sizeNode,this._size]),this.layout=h.lift(function(t,i,e){return!(!t||!e)&&(i?d(i,t,e):t)},[this._layout,this._layoutNode,this.size]),this.layout.on("start",function(){this._currentTarget&&a.promoteLayer(this._currentTarget)}.bind(this)),this.layout.on("update",function(t){this._currentTarget&&this._elementOutput.commitLayout(this._currentTarget,t,this._cachedSpec)}.bind(this)),this.layout.on("end",function(t){this._currentTarget&&(this._elementOutput.commitLayout(this._currentTarget,t,this._cachedSpec),a.demoteLayer(this._currentTarget))}.bind(this)),this.size.on("start",o.bind(this)),this.size.on("update",o.bind(this)),this.size.on("end",o.bind(this)),t&&this.setOptions(t)}function o(t){if(this._currentTarget){var i=this._cachedSpec.size,e=this._elementOutput.commitSize(this._currentTarget,t,i);this._cachedSize=t,e&&(this._cachedSpec.size=t,this.emit("resize",t))}}function r(){this.addClass("samsara-scrollable"),v&&this.on("deploy",function(t){y&&t.addEventListener("touchstart",function(){var i=t.scrollTop,e=t.offsetHeight,n=t.scrollHeight;0===i?t.scrollTop=1:i+e===n&&(t.scrollTop=n-e-1)},!1),t.addEventListener("touchmove",function(t){t.stopPropagation()},!1)})}var a=e(37),u=e(3),h=e(16),c=e(32),p=e(29),l=e(34),d=e(33),f=e(7),v="ontouchstart"in window,y=/iPad|iPhone|iPod/.test(navigator.platform);s.prototype.elementType="div",s.prototype.elementClass="samsara-surface",s.prototype.setContent=function(t,i){this.content!==t&&(this.content=t,this._currentTarget&&f.push(function(){a.applyContent(this._currentTarget,t),"function"==typeof i&&i(this)}.bind(this)))},s.prototype.getContent=function(){return this.content},s.prototype.setAttributes=function(t){for(var i in t){var e=t[i];void 0!==e&&(this.attributes[i]=t[i])}this._currentTarget&&f.push(function(){a.applyAttributes(this._currentTarget,t)}.bind(this))},s.prototype.getAttributes=function(){return this.attributes},s.prototype.setProperties=function(t){for(var i in t)this.properties[i]=t[i];this._currentTarget&&f.push(function(){a.applyProperties(this._currentTarget,t)}.bind(this))},s.prototype.getProperties=function(){return this.properties},s.prototype.addClass=function(t){this.classList.indexOf(t)<0&&(this.classList.push(t),this._currentTarget&&f.push(function(){a.applyClasses(this._currentTarget,this.classList)}.bind(this)))},s.prototype.removeClass=function(t){var i=this.classList.indexOf(t);i>=0&&(this.classList.splice(i,1),this._currentTarget&&f.push(function(){a.removeClasses(this._currentTarget,this.classList)}.bind(this)))},s.prototype.toggleClass=function(t){var i=this.classList.indexOf(t);i===-1?this.addClass(t):this.removeClass(t)},s.prototype.setClasses=function(t){for(var i=0;i<t.length;i++)this.addClass(t[i])},s.prototype.getClassList=function(){return this.classList},s.prototype.querySelector=function(t){if(this._currentTarget)return a.querySelector(this._currentTarget,t)},s.prototype.querySelectorAll=function(t){if(this._currentTarget)return a.querySelectorAll(this._currentTarget,t)},s.prototype.setOptions=function(t){void 0!==t.tagName&&(this.elementType=t.tagName),void 0!==t.opacity&&this.setOpacity(t.opacity),void 0!==t.size&&this.setSize(t.size),void 0!==t.origin&&this.setOrigin(t.origin),void 0!==t.proportions&&this.setProportions(t.proportions),void 0!==t.margins&&this.setMargins(t.margins),void 0!==t.classes&&this.setClasses(t.classes),void 0!==t.properties&&this.setProperties(t.properties),void 0!==t.attributes&&this.setAttributes(t.attributes),void 0!==t.content&&this.setContent(t.content),void 0!==t.aspectRatio&&this.setAspectRatio(t.aspectRatio),t.enableScroll&&r.call(this),t.roundToPixel&&(this._elementOutput._roundToPixel=t.roundToPixel)},s.prototype.on=function(t,i){this._currentTarget&&a.on(this._currentTarget,t,this._eventForwarder),u.prototype.on.apply(this._eventOutput,arguments)},s.prototype.once=function(t,i){this._currentTarget&&this._elementOutput.once(this._currentTarget,t,this._eventForwarder),u.prototype.once.apply(this._eventOutput,arguments)},s.prototype.off=function(t,i){this._currentTarget&&a.off(this._currentTarget,t,this._eventForwarder),u.prototype.off.apply(this._eventOutput,arguments)},s.prototype.setup=function(t){if(!this._currentTarget){this._allocator=t;var i=t.allocate(this.elementType);if(this._currentTarget=i,this.elementClass)if(this.elementClass instanceof Array)for(var e=0;e<this.elementClass.length;e++)this.addClass(this.elementClass[e]);else this.addClass(this.elementClass);for(var n in this._eventOutput.listeners)a.on(i,n,this._eventForwarder);this.deploy(this._currentTarget)}},s.prototype.remove=function(){var t=this._currentTarget;if(t){for(var i in this._eventOutput.listeners)a.off(t,i,this._eventForwarder);this.recall(t),this._allocator.deallocate(t),this._allocator=null,this._cachedSpec={},this._currentTarget=null}},s.prototype.deploy=function(t){a.makeVisible(t,this._cachedSize),a.applyClasses(t,this.classList),a.applyProperties(t,this.properties),a.applyAttributes(t,this.attributes),a.applyContent(t,this.content),this._eventOutput.emit("deploy",t)},s.prototype.recall=function(t){this._eventOutput.emit("recall"),a.demoteLayer(t),a.removeClasses(t,this.classList),a.removeProperties(t,this.properties),a.removeAttributes(t,this.attributes),a.makeInvisible(t),this.content=a.recallContent(t)},s.prototype.getSize=function(){return this._cachedSize},s.prototype.setSize=function(t){this._cachedSize=t,this._sizeNode.set({size:t})},s.prototype.setProportions=function(t){this._sizeNode.set({proportions:t})},s.prototype.setMargins=function(t){this._sizeNode.set({margins:t})},s.prototype.setAspectRatio=function(t){this._sizeNode.set({aspectRatio:t})},s.prototype.setOrigin=function(t){this._layoutNode.set({origin:t}),this._elementOutput._originDirty=!0},s.prototype.setOpacity=function(t){this._layoutNode.set({opacity:t}),this._elementOutput._opacityDirty=!0},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){t=t||{},this._opacityDirty=!0,this._originDirty=!0,this._transformDirty=!0,this._isVisible=!0,this._roundToPixel=t.roundToPixel||!1}function o(t,i){return 1===i?Math.round(t):Math.round(t*i)/i}function r(t,i){for(var e=g,n=0;n<15;n++)Math.abs(t[n])<m&&(t[n]=0),e+=12===n||13===n?o(t[n],i)+b:t[n]+b;return e+t[15]+O}function a(t){return 100*t[0]+"% "+100*t[1]+"%"}function u(t,i){return t&&i?t[0]!==i[0]||t[1]!==i[1]:t!==i}function h(t,i){i[0]===!0?i[0]=t.offsetWidth:i[0]>=0&&(t.style.width=i[0]+I),i[1]===!0?i[1]=t.offsetHeight:i[1]>=0&&(t.style.height=i[1]+I)}function c(t,i){!this._isVisible&&i>v&&(t.style.pointerEvents="auto",this._isVisible=!0),i>y?i=y:i<v&&(i=v,this._isVisible&&(t.style.pointerEvents="none",this._isVisible=!1)),t.style.opacity=i}var p=e(9),l=!("transform"in window.document.documentElement.style),d=!("perspective"in window.document.documentElement.style),f=2*(window.devicePixelRatio||1),v=1e-4,y=.9999,m=1e-5,_=[0,0],g="matrix3d(",b=",",O=")",I="px",x=l?function(t,i){t.style.webkitTransformOrigin=a(i)}:function(t,i){t.style.transformOrigin=a(i)},T=l?function(t,i,e){t.style.webkitTransform=r(i,e)}:function(t,i,e){t.style.transform=r(i,e)},w=d?function(t,i){t.style.webkitPerspective=i?(0|i)+"px":"0px"}:function(t,i){t.style.perspective=i?(0|i)+"px":"0px"},S=d?function(t,i){t.style.webkitPerspectiveOrigin=i?a(i):"50% 50%"}:function(t,i){t.style.perspectiveOrigin=i?a(i):"50% 50%"};s.getWidth=function(t){return t.clientWidth},s.getHeight=function(t){return t.clientHeight},s.getSize=function(t){return[this.getWidth(t),this.getHeight(t)]},s.querySelector=function(t,i){return t.querySelector(i)},s.querySelectorAll=function(t,i){return t.querySelectorAll(i)},s.applyClasses=function(t,i){for(var e=0;e<i.length;e++)t.classList.add(i[e])},s.applyClass=function(t,i){t.classList.add(i)},s.applyProperties=function(t,i){for(var e in i)t.style[e]=i[e]},s.applyAttributes=function(t,i){for(var e in i)t.setAttribute(e,i[e])},s.removeClass=function(t,i){t.classList.remove(i)},s.removeClasses=function(t,i){for(var e=0;e<i.length;e++)t.classList.remove(i[e])},s.removeProperties=function(t,i){for(var e in i)t.style[e]=""},s.removeAttributes=function(t,i){for(var e in i)t.removeAttribute(e)},s.on=function(t,i,e,n){t.addEventListener(i,e,n||!1)},s.off=function(t,i,e){t.removeEventListener(i,e)},s.applyContent=function(t,i){if(i instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(i)}else t.innerHTML=i},s.recallContent=function(t){for(var i=document.createDocumentFragment();t.hasChildNodes();)i.appendChild(t.firstChild);return i},s.promoteLayer=function(t){t.style.willChange="transform, opacity"},s.demoteLayer=function(t){t.style.willChange=""},s.makeVisible=function(t,i){t.style.display="",i&&(i[0]===!0&&(t.style.width="auto"),i[1]===!0&&(t.style.height="auto"))},s.makeInvisible=function(t){t.style.display="none",t.style.opacity="",t.style.width="",t.style.height="",l?(t.style.webkitTransform="",t.style.webkitTransformOrigin=""):(t.style.transform="",t.style.transformOrigin="")},s.prototype.commitPerspective=w,s.prototype.commitPerspectiveOrigin=S,s.prototype.commitLayout=function(t,i,e){var n=i.transform||p.identity,s=void 0===i.opacity?1:i.opacity,o=i.origin||_;this._transformDirty=p.notEquals(e.transform,n),this._opacityDirty=this._opacityDirty||e.opacity!==s,this._originDirty=this._originDirty||e&&u(e.origin,o),this._opacityDirty&&(e.opacity=s,c.call(this,t,s)),this._originDirty&&(e.origin=o,x(t,o)),this._transformDirty&&(e.transform=n,T(t,n,this._roundToPixel?1:f)),this._originDirty=!1,this._transformDirty=!1,this._opacityDirty=!1},s.prototype.commitSize=function(t,i,e){return i[0]!==!0&&(i[0]=o(i[0],f)),i[1]!==!0&&(i[1]=o(i[1],f)),!!u(e,i)&&(h(t,i),!0)},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){o.call(this,t),this.context=new r,this.context.elementClass=s.prototype.elementClass,this.context._size.subscribe(this.size),this.on("deploy",function(t){this.context.mount(t)}.bind(this)),this.on("recall",function(){this.context.remove()}.bind(this))}var o=e(36),r=e(39);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.elementType="div",s.prototype.elementClass=["samsara-surface","samsara-container"],s.prototype.getPerspective=function(){return r.prototype.getPerspective.apply(this.context,arguments)},s.prototype.setPerspective=function(){r.prototype.setPerspective.apply(this.context,arguments)},s.prototype.add=function(){return r.prototype.add.apply(this.context,arguments)},s.prototype.remove=function(){o.prototype.remove.apply(this,arguments)},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){function i(t){var i=t.type;return"touchstart"===i&&(e=!0),!e||"m"!==i[0]||("mouseup"===i&&(e=!1),!1)}this.options=c.setOptions(this,t,s.DEFAULT_OPTIONS),this._node=new u,this.container=null,this._domOutput=new r,this._size=new p,this._layout=new p,this._cachedSize=[],this.size=this._size.map(function(t){if("end"===t)return this._cachedSize;var i=r.getWidth(this.container),e=r.getHeight(this.container);return(i!==this._cachedSize[0]||e!==this._cachedSize[1])&&(this._cachedSize[0]=i,this._cachedSize[1]=e,this.emit("resize",this._cachedSize),[i,e])}.bind(this)),this._perspective=new h,this._perspectiveOrigin=new h,this.perspectiveFrom(this._perspective),this.perspectiveOriginFrom(this._perspectiveOrigin),this._eventOutput=new l,this._eventForwarder=function(t){t.stopPropagation();var e=i.call(this,t);e&&this._eventOutput.emit(t.type,t)}.bind(this);var e=!1;this.options.enableScroll===!1&&this.on("deploy",function(t){r.on(t,"touchmove",function(t){t.preventDefault()},!1)})}var o=e(40),r=e(37),a=e(2),u=e(41),h=e(11),c=e(27),p=e(12),l=e(3);s.prototype.elementClass="samsara-context",s.DEFAULT_OPTIONS={enableScroll:!1},s.prototype.add=function(){return u.prototype.add.apply(this._node,arguments)},s.prototype.perspectiveFrom=function(t){this._perspective.unsubscribe(),this._perspective=t,this._perspective.on("update",function(t){this._domOutput.commitPerspective(this.container,t)}.bind(this)),this._perspective.on("end",function(t){this._domOutput.commitPerspective(this.container,t)}.bind(this))},s.prototype.perspectiveOriginFrom=function(t){this._perspectiveOrigin.unsubscribe(),this._perspectiveOrigin=t,this._perspectiveOrigin.on("update",function(t){this._domOutput.commitPerspectiveOrigin(this.container,t)}.bind(this)),this._perspectiveOrigin.on("end",function(t){this._domOutput.commitPerspectiveOrigin(this.container,t)}.bind(this))},s.prototype.getPerspective=function(){return this._perspective.get()},s.prototype.setPerspective=function(t,i,e){this.container?this._perspective.set(t,i,e):this.on("deploy",function(){this._perspective.set(t,i,e)}.bind(this))},s.prototype.setPerspectiveOrigin=function(t,i,e){this.container?this._perspectiveOrigin.set(t,i,e):this.on("deploy",function(){this._perspectiveOrigin.set(t,i,e)}.bind(this))},s.prototype.mount=function(t){t=t||window.document.body,this.container=t,this.elementClass instanceof Array?r.applyClasses(this.container,this.elementClass):r.applyClass(this.container,this.elementClass);var i=new o(this.container);this._node.setAllocator(i),this._node._size.subscribe(this.size),this._node._layout.subscribe(this._layout),this.emit("deploy",this.container),a.registerContext(this)},s.prototype.remove=function(){this.elementClass instanceof Array?r.removeClasses(this.container,this.elementClass):r.removeClass(this.container,this.elementClass),this._node.remove(),r.recallContent(this.container),a.deregisterContext(this)},s.prototype.on=function(t,i){this.container?this.container.addEventListener(t,this._eventForwarder):this._eventOutput.on("deploy",function(i){i.addEventListener(t,this._eventForwarder)}.bind(this)),l.prototype.on.apply(this._eventOutput,arguments)},s.prototype.off=function(t,i){l.prototype.off.apply(this._eventOutput,arguments)},s.prototype.emit=function(t,i){l.prototype.emit.apply(this._eventOutput,arguments)},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,e){function n(t){this.set(t),this.detachedNodes={}}n.prototype.set=function(t){t||(t=document.createDocumentFragment()),this.container=t},n.prototype.migrate=function(t){var i=this.container;if(t!==i){if(i instanceof DocumentFragment)t.appendChild(i);else for(;i.hasChildNodes();)t.appendChild(i.firstChild);this.container=t}},n.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var i,e=this.detachedNodes[t];return 0===e.length?(i=document.createElement(t),this.container.appendChild(i)):i=e.shift(),i},n.prototype.deallocate=function(t){var i=t.nodeName.toLowerCase(),e=this.detachedNodes[i];e.push(t)},e.exports=n}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.allocator=null,o.call(this),t&&this.setAllocator(t)}var o=e(28);s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.setAllocator=function(t){this.allocator=t,this._logic.trigger("mount",this)},s.prototype.remove=function(){this.allocator=null,o.prototype.remove.apply(this,arguments)},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){n.exports={EventEmitter:e(4),EventHandler:e(3),EventMapper:e(13),EventFilter:e(14),EventSplitter:e(15)}}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){n.exports={GenericInput:e(44),MouseInput:e(45),TouchInput:e(46),ScrollInput:e(48),ScaleInput:e(49),RotateInput:e(51),PinchInput:e(52)}}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t,i){this._eventInput=new r,this._eventOutput=new r,r.setInputHandler(this,this._eventInput),r.setOutputHandler(this,this._eventOutput),this._inputs={},t&&this.addInput(t,i)}function o(t,i){u[t]&&(this._inputs[t]=new u[t](i),this.subscribeInput(t))}var r=e(3),a=e(12),u={};s.prototype=Object.create(a.prototype),s.prototype.constructor=s,s.DIRECTION={X:0,Y:1},s.register=function(t){for(var i in t){if(u[i]){if(u[i]===t[i])continue;throw new Error("this key is registered to a different input class")}u[i]=t[i]}},s.prototype.setOptions=function(t){for(var i in this._inputs)this._inputs[i].setOptions(t)},s.prototype.subscribeInput=function(t){var i=this._inputs[t];i.subscribe(this._eventInput),this._eventOutput.subscribe(i)},s.prototype.unsubscribeInput=function(t){var i=this._inputs[t];i.unsubscribe(this._eventInput),this._eventOutput.unsubscribe(i)},s.prototype.getInput=function(t){return this._inputs[t]},s.prototype.addInput=function(t,i){if(t instanceof Array)for(var e=0;e<t.length;e++)o.call(this,t[e],i);else if(t instanceof Object)for(var n in t)o.call(this,n,t[n])},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=p.setOptions(this,t),this._eventInput=new c,this._eventOutput=new c,c.setInputHandler(this,this._eventInput),c.setOutputHandler(this,this._eventOutput),this.boundMove=null,this.boundUp=null,this._eventInput.on("mousedown",o.bind(this)),this._eventInput.on("mousemove",r.bind(this)),this._eventInput.on("mouseup",a.bind(this)),this._eventInput.on("mouseenter",u.bind(this)),this._eventInput.on("mouseleave",h.bind(this)),this._payload={x:0,y:0,delta:null,value:null,cumulate:null,velocity:null},this._value=null,this._cumulate=null,this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._move=!1}function o(t){var i,e;t.preventDefault();var n=t.clientX,o=t.clientY;this._prevCoord=[n,o],this._prevTime=f(),this._down=!0,this._move=!1;var r=this._payload;void 0!==this.options.direction?(null===this._cumulate&&(this._cumulate=0),this._value=0,i=0,e=0,this.options.direction===s.DIRECTION.X&&(r.x=n),this.options.direction===s.DIRECTION.Y&&(r.y=o)):(null===this._cumulate&&(this._cumulate=[0,0]),this._value=[0,0],i=[0,0],e=[0,0],r.x=n,r.y=o),r.delta=i,r.value=this._value,r.cumulate=this._cumulate,r.velocity=e,r.event=t,this._eventOutput.emit("start",r)}function r(t){if(!this._down)return!1;var i=this.options.direction,e=this.options.scale,n=this._prevCoord,o=this._prevTime,r=t.clientX,a=t.clientY,u=f(),h=e*(r-n[0]),c=e*(a-n[1]);if(this.options.rails&&void 0!==i){var p=i===s.DIRECTION.X&&Math.abs(h)<Math.abs(.5*c)||i===s.DIRECTION.Y&&Math.abs(c)<Math.abs(.5*h);if(p)return!1}var l,v,y=Math.max(u-o,d),m=1/y,_=h*m,g=c*m,b=this._payload;i===s.DIRECTION.X?(b.x=r,v=h,l=_,this._value+=v,this._cumulate+=v):i===s.DIRECTION.Y?(b.y=a,v=c,l=g,this._value+=v,this._cumulate+=v):(b.x=r,b.y=a,v=[h,c],l=[_,g],this._value[0]+=v[0],this._value[1]+=v[1],this._cumulate[0]+=v[0],this._cumulate[1]+=v[1]),b.delta=v,b.value=this._value,b.cumulate=this._cumulate,b.velocity=l,b.event=t,b.dt=y,this._eventOutput.emit("update",b),this._prevCoord=[r,a],this._prevTime=u,this._move=!0}function a(t){return!!this._down&&(this._payload.event=t,this._eventOutput.emit("end",this._payload),this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,void(this._move=!1))}function u(t){return!(!this._down||!this._move)&&(this._eventInput.off("mousemove",r.bind(this)),this._eventInput.off("mouseup",a.bind(this)),document.removeEventListener("mousemove",this.boundMove),void document.removeEventListener("mouseup",this.boundUp))}function h(t){return!(!this._down||!this._move)&&(this.boundMove=r.bind(this),this.boundUp=function(t){a.call(this,t),document.removeEventListener("mousemove",this.boundMove),document.removeEventListener("mouseup",this.boundUp)}.bind(this,t),this._eventInput.off("mousemove",r.bind(this)),this._eventInput.off("mouseup",a.bind(this)),document.addEventListener("mousemove",this.boundMove),void document.addEventListener("mouseup",this.boundUp))}var c=e(3),p=e(27),l=e(12),d=8,f=Date.now;s.prototype=Object.create(l.prototype),s.prototype.constructor=s,s.DEFAULT_OPTIONS={direction:void 0,scale:1,rails:!1},s.DIRECTION={X:0,Y:1},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=p.setOptions(this,t),this._eventOutput=new h,this._touchTracker=new u(this.options),h.setOutputHandler(this,this._eventOutput),h.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",o.bind(this)),this._touchTracker.on("trackmove",r.bind(this)),this._touchTracker.on("trackend",a.bind(this)),this._payload={},this._cumulate={},this._value={}}function o(t){var i,e,n=t.touchId,o={};void 0!==this.options.direction?(this.options.direction===s.DIRECTION.X&&(o.x=t.x),this.options.direction===s.DIRECTION.Y&&(o.y=t.y),this._cumulate[n]||(this._cumulate[n]=0),this._value[n]=0,i=0,e=0):(this._cumulate[n]||(this._cumulate[n]=[0,0]),this._value[n]=[0,0],i=[0,0],e=[0,0],o.x=t.x,o.y=t.y),o.delta=e,o.value=this._value[n],o.cumulate=this._cumulate[n],o.velocity=i,o.count=t.count,o.touchId=t.touchId,o.event=t.event,o.timestamp=t.timestamp,o.dt=0,this._payload[t.touchId]=o,this._eventOutput.emit("start",o)}function r(t){var i=this.options.direction,e=t.touchId,n=this._payload[e],o=this.options.scale,r=t.history[0],a=r.timestamp,u=t.timestamp,h=t.x,c=t.y,p=o*(h-r.x),d=o*(c-r.y);this.options.rails&&(i===s.DIRECTION.X&&Math.abs(d)>Math.abs(p)&&(d=0),i===s.DIRECTION.Y&&Math.abs(p)>Math.abs(d)&&(p=0));var f,v,y=Math.max(u-a,l),m=1/y,_=p*m,g=d*m;i===s.DIRECTION.X?(n.x=h,v=p,f=_,this._value[e]+=v,this._cumulate[e]+=v):i===s.DIRECTION.Y?(n.y=c,v=d,f=g,this._value[e]+=v,this._cumulate[e]+=v):(n.x=h,n.y=c,v=[p,d],f=[_,g],this._value[e][0]+=v[0],this._value[e][1]+=v[1],this._cumulate[e][0]+=v[0],this._cumulate[e][1]+=v[1]),n.delta=v,n.velocity=f,n.value=this._value[e],n.cumulate=this._cumulate[e],n.count=t.count,n.touchId=t.touchId,n.event=t.event,n.timestamp=t.timestamp,n.dt=y,this._eventOutput.emit("update",n)}function a(t){var i=t.touchId,e=this._payload[i];e.count=t.count,e.event=t.event,e.timestamp=t.timestamp,this._eventOutput.emit("end",e),delete this._payload[i],delete this._value[i],delete this._cumulate[i]}var u=e(47),h=e(3),c=e(12),p=e(27),l=8;s.prototype=Object.create(c.prototype),s.prototype.constructor=s,s.DEFAULT_OPTIONS={direction:void 0,scale:1,rails:!1,track:1,limit:1/0},s.DIRECTION={X:0,Y:1},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=h.setOptions(this,t),this.history={},this.numTouches=0,this._eventInput=new c,this._eventOutput=new c,c.setInputHandler(this,this._eventInput),c.setOutputHandler(this,this._eventOutput),this._eventInput.on("touchstart",r.bind(this)),this._eventInput.on("touchmove",a.bind(this)),this._eventInput.on("touchend",u.bind(this)),this._eventInput.on("touchcancel",u.bind(this))}function o(t,i,e){return{x:t.clientX,y:t.clientY,touchId:t.identifier,timestamp:p(),count:i.touches.length,event:t,history:e}}function r(t){if(t.touches.length>this.options.limit)return!1;if(this.numTouches>=this.options.track)return!1;for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i],n=e.identifier,s=o(e,t,null);this._eventOutput.emit("trackstart",s),this.history[n]||this.track(n,s)}}function a(t){if(t.touches.length>this.options.limit)return!1;if(this.numTouches>this.options.track)return!1;t.preventDefault();for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i],n=this.history[e.identifier];if(n){var s=o(e,t,n),r=n[this.options.memory-1];if(s.x===r.x&&s.y===r.y)continue;this._eventOutput.emit("trackmove",s),n.length>=this.options.memory&&n.shift(),n.push(s)}}}function u(t){if(t.touches.length>this.options.limit)return!1;if(this.numTouches>this.options.track)return!1;for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i],n=e.identifier,s=this.history[n];if(s){var r=o(e,t,s);this._eventOutput.emit("trackend",r),this.untrack(n)}}}var h=e(27),c=e(3),p=Date.now;s.DEFAULT_OPTIONS={track:1,limit:1/0,memory:1},s.prototype.track=function(t,i){this.numTouches++,this.history[t]=[i]},s.prototype.untrack=function(t){this.numTouches--,delete this.history[t]},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=a.setOptions(this,t),this._payload={delta:null,value:null,cumulate:null,velocity:null,event:null},this._eventInput=new r,this._eventOutput=new r,r.setInputHandler(this,this._eventInput),r.setOutputHandler(this,this._eventOutput),this._eventInput.on("wheel",o.bind(this)),this._value=void 0===this.options.direction?[0,0]:0,this._cumulate=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._inProgress=!1;var i=this;this._scrollEnd=h.debounce(function(t){i._inProgress=!1,0!==i._payload.delta&&(i._payload.velocity=0),i._payload.event=t,i._eventOutput.emit("end",i._payload)},100)}function o(t){if(t.preventDefault(),!this._inProgress)return this._value=void 0===this.options.direction?[0,0]:0,v=this._payload,v.value=this._value,v.cumulate=this._cumulate,v.event=t,this._eventOutput.emit("start",v),void(this._inProgress=!0);var i=l(),e=this._prevTime||i,n=-t.deltaX,o=-t.deltaY;n>p&&(n=p),o>p&&(o=p),n<-p&&(n=-p),o<-p&&(o=-p);var r=1/Math.max(i-e,c);this._prevTime=i;var a,u,h=n*r,d=o*r,f=this.options.scale;this.options.direction===s.DIRECTION.X?(u=f*n,a=f*h,this._value+=u,this._cumulate+=u):this.options.direction===s.DIRECTION.Y?(u=f*o,a=f*d,this._value+=u,this._cumulate+=u):(u=[f*n,f*o],a=[f*h,f*d],this._value[0]+=u[0],this._value[1]+=u[1],this._cumulate[0]+=u[0],this._cumulate[1]+=u[1]);var v=this._payload;v.delta=u,v.velocity=a,v.value=this._value,v.cumulate=this._cumulate,v.event=t,this._eventOutput.emit("update",v),this._scrollEnd(t)}var r=e(3),a=e(27),u=e(12),h=e(10),c=8,p=50;s.prototype=Object.create(u.prototype),s.prototype.constructor=s,s.DEFAULT_OPTIONS={direction:void 0,scale:1},s.DIRECTION={X:0,Y:1};var l=Date.now;n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=h.setOptions(this,t),this._eventInput=new u(this.options),this._eventOutput=new c,c.setInputHandler(this,this._eventInput),c.setOutputHandler(this,this._eventOutput),this._eventInput.on("twoFingerStart",o.bind(this)),this._eventInput.on("twoFingerUpdate",r.bind(this)),this._eventInput.on("twoFingerEnd",a.bind(this)),this.payload={delta:0,velocity:0,value:0,cumulate:0,center:[]},this.startDist=0,this.prevDist=0,this.value=1,this.cumulate=1}function o(t){
var i=u.calculateCenter.call(this,t[0].position,t[1].position),e=u.calculateDistance.call(this,t[0].position,t[1].position);this.startDist=e,this.prevDist=e,this.value=1;var n=this.payload;n.value=this.value,n.center=i,this._eventOutput.emit("start",n),this.value=e}function r(t){var i=u.calculateCenter.call(this,t[0].position,t[1].position),e=u.calculateDistance.call(this,t[0].position,t[1].position),n=this.options.scale,s=n*(e-this.prevDist)/this.startDist,o=2*s/(t[0].dt+t[1].dt);this.value+=s,this.cumulate+=s;var r=this.payload;r.delta=s,r.cumulate=this.cumulate,r.velocity=o,r.value=this.value,r.center=i,this._eventOutput.emit("update",r),this.prevDist=e}function a(){this._eventOutput.emit("end",this.payload)}var u=e(50),h=e(27),c=e(3);s.prototype=Object.create(u.prototype),s.prototype.constructor=s,s.DEFAULT_OPTIONS={direction:void 0,scale:1,rails:!1},s.DIRECTION={X:0,Y:1},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=p.setOptions(this,t),this._eventInput=new l(this.options),this._eventOutput=new h,h.setInputHandler(this,this._eventInput),h.setOutputHandler(this,this._eventOutput),this.payload=[],this.touchIdA=void 0,this.touchIdB=void 0,this.posA=null,this.posB=null,this._eventInput.on("start",r.bind(this)),this._eventInput.on("update",a.bind(this)),this._eventInput.on("end",u.bind(this))}function o(t){var i,e=this.options.direction;return i=e===s.DIRECTION.X?t.pageX:e===s.DIRECTION.Y?t.pageY:[t.pageX,t.pageY]}function r(t){t.position=o.call(this,t.event),this.touchIdA===t.touchId&&(this.payload[0]=t),void 0===this.touchIdA?(this.touchIdA=t.touchId,this.payload[0]=t):void 0===this.touchIdB&&(this.touchIdB=t.touchId,this.payload[1]=t,this.emit("twoFingerStart",this.payload))}function a(t){return void 0!==this.touchIdA&&void 0!==this.touchIdB&&(t.position=o.call(this,t.event),t.touchId===this.touchIdA?this.payload[0]=t:t.touchId===this.touchIdB&&(this.payload[1]=t),void this.emit("twoFingerUpdate",this.payload))}function u(t){return void 0===this.touchIdA||void 0===this.touchIdB?(this.touchIdA=void 0,this.touchIdB=void 0,!1):(this.emit("twoFingerEnd",this.payload),this.touchIdA=void 0,this.touchIdB=void 0,void(this.payload=[]))}var h=e(3),c=e(12),p=e(27),l=e(46);s.prototype=Object.create(c.prototype),s.prototype.constructor=s,s.DIRECTION={X:0,Y:1},s.DEFAULT_OPTIONS={direction:void 0,rails:!1,track:2},s.calculateAngle=function(t,i){if(void 0!==this.options.direction)return 0;var e=i[0]-t[0],n=i[1]-t[1];return Math.atan2(n,e)},s.calculateDistance=function(t,i){var e=this.options.direction;if(void 0===e){var n=i[0]-t[0],s=i[1]-t[1];return Math.sqrt(n*n+s*s)}return Math.abs(i-t)},s.calculateCenter=function(t,i){return void 0===this.options.direction?[.5*(t[0]+i[0]),.5*(t[1]+i[1])]:t+i},s.calculateVelocity=function(t,i){return void 0===this.options.direction?[.5*(t[0]+i[0]),.5*(t[1]+i[1])]:.5*(t+i)},s.calculateOrientation=function(t,i){return void 0===this.options.direction?[i[0]-t[0],i[1]-t[1]]:i-t},s.detectOrientationChange=function(t,i){return void 0===this.options.direction?t[0]*i[0]+t[1]*i[1]<=0:t*i<=0},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=h.setOptions(this,t),this._eventInput=new u(this.options),this._eventOutput=new c,c.setInputHandler(this,this._eventInput),c.setOutputHandler(this,this._eventOutput),this._eventInput.on("twoFingerStart",o.bind(this)),this._eventInput.on("twoFingerUpdate",r.bind(this)),this._eventInput.on("twoFingerEnd",a.bind(this)),this.payload={count:0,delta:0,velocity:0,value:1,cumulate:0,center:[]},this._angle=0,this._previousAngle=0,this.cumulate=0}function o(t){this._previousAngle=u.calculateAngle.call(this,t[0].position,t[1].position);var i=u.calculateCenter.call(this,t[0].position,t[1].position);this._angle=0;var e=this.payload;e.count=event.touches.length,e.value=this._angle,e.cumulate=this.cumulate,e.center=i,this._eventOutput.emit("start",this.payload)}function r(t){var i=u.calculateAngle.call(this,t[0].position,t[1].position),e=u.calculateCenter.call(this,t[0].position,t[1].position),n=this.options.scale,s=n*(i-this._previousAngle),o=s/t.dt;this._angle+=s,this.cumulate+=s;var r=this.payload;r.delta=s,r.cumulate=this.cumulate,r.velocity=o,r.value=this._angle,r.center=e,this._eventOutput.emit("update",r),this._previousAngle=i}function a(t){this._eventOutput.emit("update",this.payload)}var u=e(50),h=e(27),c=e(3);s.prototype=Object.create(u.prototype),s.prototype.constructor=s,s.DEFAULT_OPTIONS={scale:1},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=c.setOptions(this,t),this._eventInput=new h(this.options),this._eventOutput=new u,u.setInputHandler(this,this._eventInput),u.setOutputHandler(this,this._eventOutput),this._eventInput.on("twoFingerStart",o.bind(this)),this._eventInput.on("twoFingerUpdate",r.bind(this)),this._eventInput.on("twoFingerEnd",a.bind(this)),this.payload={delta:null,velocity:null,value:null,center:[]},this.value=0,this.direction=[]}function o(t){var i=h.calculateCenter.call(this,t[0].position,t[1].position),e=h.calculateDistance.call(this,t[0].position,t[1].position);this.direction=h.calculateOrientation.call(this,t[0].position,t[1].position);var n=this.payload;n.value=e,n.center=i,this._eventOutput.emit("start",n),this.value=e}function r(t){var i,e=h.calculateCenter.call(this,t[0].position,t[1].position),n=h.calculateDistance.call(this,t[0].position,t[1].position),s=h.calculateOrientation.call(this,t[0].position,t[1].position),o=h.detectOrientationChange.call(this,s,this.direction),r=this.options.scale;o&&(n*=-1),i=r*(n-this.value);var a=2*i/(t[0].dt+t[1].dt),u=this.payload;u.delta=i,u.velocity=a,u.value=this.value,u.center=e,this._eventOutput.emit("update",u),this.value=n}function a(){this._eventOutput.emit("end",this.payload)}var u=e(3),h=e(50),c=e(27);s.prototype=Object.create(h.prototype),s.prototype.constructor=s,s.DIRECTION={X:0,Y:1},s.DEFAULT_OPTIONS={scale:1,direction:void 0,rails:!0},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){n.exports={DrawerLayout:e(54),FlexibleLayout:e(57),GridLayout:e(59),SequentialLayout:e(60),HeaderFooterLayout:e(61),Scrollview:e(62)}}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){var i=f.SIDE,e=f.DIRECTION;return t===i.LEFT||t===i.RIGHT?e.X:e.Y}function o(t){var i=f.SIDE;return t===i.LEFT||t===i.TOP?f.ORIENTATION.POSITIVE:f.ORIENTATION.NEGATIVE}function r(t){var i=t.key,e=t.value;"side"!==i&&(this.direction=s(e),this.orientation=o(e)),this.options.revealLength*=this.direction}var a=e(9),u=e(11),h=e(25),c=e(16),p=e(55),l=e(56),d=e(13),f={DIRECTION:{X:0,Y:1},SIDE:{LEFT:0,TOP:1,RIGHT:2,BOTTOM:3},ORIENTATION:{POSITIVE:1,NEGATIVE:-1}},v=h.extend({defaults:{side:f.SIDE.LEFT,revealLength:void 0,velocityThreshold:1/0,positionThreshold:0,transitionOpen:!0,transitionClose:!0},events:{change:r},initialize:function(t){this.direction=s(t.side),this.orientation=o(t.side),this.options.revealLength*=this.orientation,this.isOpen=!1,this.transitionStream=new u(0);var i=new c({start:function(){return this.transitionStream.halt(),0}.bind(this),update:function(i){var e=i.delta,n=e,s=t.revealLength,o=this.position.get(),r=o+e,a=0,u=0;return this.orientation===f.ORIENTATION.POSITIVE?u=s:a=s,(r>=u||r<=a)&&(n=r>u&&r>a&&o!==u?u-o:r<a&&o!==a?a-o:0),n}.bind(this),end:function(i){var e=i.velocity,n=this.orientation,s=this.position.get(),o=t.revealLength,r=n*o,a=t.positionThreshold||r/2,u=t.velocityThreshold;if(0===s)return this.isOpen=!1,!1;if(s===r)return this.isOpen=!0,!1;var h=s>=a&&(e>-u||e>u)||s<a&&e>u;h?(this.options.transitionOpen.velocity=e,this.open(this.options.transitionOpen,function(){this.options.transitionOpen.velocity=0}.bind(this))):(this.options.transitionClose.velocity=e,this.close(this.options.transitionClose,function(){this.options.transitionClose.velocity=0}.bind(this)))}.bind(this)});i.subscribe(this.input);var e=new p;e.subscribe(this.transitionStream),this.position=new l(0),this.position.subscribe(i),this.position.subscribe(e);var n=new d(function(t){return{value:t,progress:t/this.options.revealLength}}.bind(this));this.output.subscribe(n).subscribe(this.position)},addDrawer:function(t){void 0===this.options.revealLength&&(this.options.revealLength=t.getSize()[this.direction]),this.drawer=t,this.add({transform:a.behind}).add(this.drawer)},addContent:function(t){var i=this.position.map(function(t){return this.direction===f.DIRECTION.X?a.translateX(t):a.translateY(t)}.bind(this));this.add({transform:i}).add(t)},open:function(t,i){void 0===t&&(t=this.options.transitionOpen),this.setPosition(this.options.revealLength,t,i),this.isOpen||(this.isOpen=!0,this.emit("open"))},close:function(t,i){void 0===t&&(t=this.options.transitionClose),this.setPosition(0,t,i),this.isOpen&&(this.isOpen=!1,this.emit("close"))},toggle:function(t){this.isOpen?this.close(t):this.open(t)},setPosition:function(t,i,e){this.transitionStream.reset(this.position.get()),this.transitionStream.set(t,i,e)},reset:function(t){this.isOpen?this.open(t):this.close(t)}},f);n.exports=v}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=r.setOptions(this,t);var i=void 0,e=void 0,n=void 0,s=!1;o.call(this,{update:function(){return e}}),this._eventInput.on("start",function(t){s=!1;var e=this.options.scale;if(t instanceof Array){if(void 0!==i){n=[];for(var o=0;o<t.length;o++)n[o]=e*(t[o]-i[o])}i=t.slice()}else void 0!==i&&(n=e*(t-i)),i=t}.bind(this)),this._eventInput.on("update",function(t){s=!0;var n=this.options.scale;if(i instanceof Array){e=[];for(var o=0;o<i.length;o++)e[o]=n*(t[o]-i[o]),i[o]=t[o]}else e=n*(t-i),i=t}.bind(this)),this._eventInput.on("end",function(t){s||void 0===n||(this.emit("update",n),i=t)}.bind(this))}var o=e(16),r=e(27);s.DEFAULT_OPTIONS={scale:1},s.prototype=Object.create(o.prototype),s.prototype.constructor=s,n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t,i){this.options=r.setOptions(this,i),this.sum=void 0,void 0!==t&&this.set(t),a.call(this,{start:function(){return this.sum||0}.bind(this),update:function(){return this.sum}.bind(this),end:function(){return this.sum||0}.bind(this)}),this._eventInput.on("start",function(t){if(void 0===this.sum)if(t instanceof Array){this.sum=[];for(var i=0;i<t.length;i++)this.sum[i]=o(t[i],this.options.min,this.options.max)}else this.sum=o(t,this.options.min,this.options.max)}.bind(this)),this._eventInput.on("update",function(t){if(t instanceof Array)for(var i=0;i<t.length;i++)this.sum[i]+=t[i],this.sum[i]=o(this.sum[i],this.options.min,this.options.max);else this.sum+=t,this.sum=o(this.sum,this.options.min,this.options.max)}.bind(this))}function o(t,i,e){return Math.min(Math.max(t,i),e)}var r=e(27),a=e(16),u=e(6),h=e(7);s.prototype=Object.create(a.prototype),s.prototype.constructor=s,s.DEFAULT_OPTIONS={min:-(1/0),max:1/0},s.prototype.set=function(t,i){if(this.sum=t,i!==!0){var e=this;u.push(function(){e.trigger("start",t),h.push(function(){e.trigger("end",t)})})}},s.prototype.get=function(){return this.sum},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){return this.options.direction===l.DIRECTION.X?r.translateX(t):r.translateY(t)}function o(t,i){var e=t.map(this.transformMap);if(void 0!==i){var n;if("number"==typeof i)this.totalFlex.set(this.totalFlex.get()+i),n=u.lift(function(t,e){if(!t)return!1;var n=(t-(this.nodes.length-1)*this.options.spacing)*(i/e);return this.options.direction===l.DIRECTION.X?[n,void 0]:[void 0,n]}.bind(this),[this.availableLength,this.totalFlex]);else{this.totalFlex.set(this.totalFlex.get()+i.get());var s=new p;s.subscribe(i),this.totalFlex.subscribe(s),n=u.lift(function(t,i,e){if(!t)return!1;var n=(t-(this.nodes.length-1)*this.options.spacing)*(i/e);return this.options.direction===l.DIRECTION.X?[n,void 0]:[void 0,n]}.bind(this),[this.availableLength,i,this.totalFlex])}return{transform:e,size:n}}return{transform:e}}var r=e(9),a=e(25),u=e(16),h=e(58),c=e(56),p=e(55),l={DIRECTION:{X:0,Y:1}},d=a.extend({defaults:{direction:l.DIRECTION.X,spacing:0},initialize:function(t){this.nodes=[],this.flexs=[],this.lengthStream=new h(function(i,e){return!!e&&i+e[t.direction]+t.spacing}),this.usedLength=new h(function(i,e){return!!e&&i+e[t.direction]}),this.availableLength=u.lift(function(i,e){return!!i&&i[t.direction]-e},[this.size,this.usedLength.headOutput]),this.totalFlex=new c(0),this.setLengthMap(s)},setLengthMap:function(t){this.transformMap=t.bind(this)},push:function(t,i){this.nodes.push(t),this.flexs.push(i),void 0===i&&this.usedLength.push(t.size);var e=this.lengthStream.push(t.size),n=o.call(this,e,i);this.add(n).add(t)},pop:function(){return this.unlink(this.nodes.length-1)},unshift:function(t,i){this.nodes.unshift(t),this.flexs.unshift(i),void 0===i&&this.usedLength.push(t.size);var e=this.lengthStream.unshift(t.size),n=o.call(this,e,i);this.add(n).add(t)},shift:function(){return this.unlink(0)},insertAfter:function(t,i,e){var n;"number"==typeof t?(n=t+1,t=this.nodes[t]):n=this.nodes.indexOf(t)+1,this.nodes.splice(n,0,i),this.flexs.splice(n,0,e),void 0===e&&this.usedLength.push(i.size);var s=this.lengthStream.insertAfter(t.size,i.size),r=o.call(this,s,e);this.add(r).add(i)},insertBefore:function(t,i,e){var n;"number"==typeof t?(n=t-1,t=this.nodes[t]):n=this.nodes.indexOf(t)-1,this.nodes.splice(n+1,0,i),this.flexs.splice(n+1,0,e),void 0===e&&this.usedLength.push(i.size);var s=this.lengthStream.insertBefore(t.size,i.size),r=o.call(this,s,e);this.add(r).add(i)},unlink:function(t){var i="number"==typeof t?t:this.nodes.indexOf(t);t=this.nodes.splice(i,1)[0];var e=this.flexs.splice(i,1)[0];return void 0===e?this.usedLength.remove(t.size):"number"==typeof e?this.totalFlex.set(this.totalFlex.get()-e):this.totalFlex.set(this.totalFlex.get()-e.get()),this.lengthStream.remove(t.size),t},length:function(){return this.nodes.length},getFlexFor:function(t){return void 0===t?this.getFlexes():"number"==typeof t?this.flexs[t]:this.flexs[this.nodes.indexOf(t)]},getFlexes:function(){return this.flexs}},l);n.exports=d}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t,i,e){this.reducer=t,this.options=e||{offset:0},this.prev=null,this.next=null,this.head=this,this.headOutput=new c,i?(this.value=i,this.input=new c,this.output=e.sources?h.lift(this.reducer,[this.input,this.value].concat(e.sources)):h.lift(this.reducer,[this.input,this.value])):(this.value=null,"number"==typeof this.options.offset?this.output=new p(this.options.offset):(this.output=new c,this.output.subscribe(this.options.offset))),u.call(this,this.head.output)}function o(t){for(var i=this;i&&i.value!==t;)i=i.next;return i}function r(t,i){t.next=null,i.prev=null,i.input.unsubscribe(t.output)}function a(t,i){t.next=i,i.prev=t,i.input.subscribe(t.output)}function u(t){this.headOutput.unsubscribe(),this.headOutput.subscribe(t)}var h=e(16),c=e(12),p=e(31);s.prototype=Object.create(h.prototype),s.prototype.constructor=s,s.prototype.push=function(t){this.head===this&&this.output.set&&this.output.set(this.options.offset||0);var i=new s(this.reducer,t,this.options);return a(this.head,i),this.head=i,u.call(this,this.head.output),i.input},s.prototype.pop=function(){var t=this.head.prev;r(t,this.head),this.head=t,u.call(this,this.head.output)},s.prototype.unshift=function(t){var i=this,e=i.next;if(!e)return this.push(t);var n=new s(this.reducer,t,this.options);return r(i,e),a(i,n),a(n,e),this.output.set&&this.output.set(this.options.offset||0),n.input},s.prototype.shift=function(){this.remove(this.next.value)},s.prototype.insertAfter=function(t,i){var e=o.call(this,t);if(e){var n=e.next;if(n){var u=new s(this.reducer,i,this.options);return r(e,n),a(u,n),a(e,u),u.input}return this.push(i)}},s.prototype.insertBefore=function(t,i){var e=o.call(this,t);if(e){var n=e.prev;if(n!==this){var u=new s(this.reducer,i,this.options);return r(n,e),a(u,e),a(n,u),u.input}return this.unshift(i)}},s.prototype.remove=function(t){var i=o.call(this,t);if(i){var e=i.prev,n=i.next;n?(r(i,n),r(e,i),a(e,n),this.output.set&&this.output.set(this.options.offset||0)):this.pop()}},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){var i=this.col.unlink(this.rows[t]);i.remove(),this.rows.splice(t,1)}var o=e(25),r=e(57),a=o.extend({defaults:{spacing:[0,0]},initialize:function(t){this.rows=[],this.col=new r({direction:r.DIRECTION.Y,spacing:t.spacing[1]}),this.add(this.col)},push:function(t,i,e){if(!(e>this.rows.length)){if(e===-1)return void this.unshift(t,i,e);void 0===e&&(e=this.rows.length);var n;e===this.rows.length?(n=new r({direction:r.DIRECTION.X,spacing:this.options.spacing[0]}),this.rows.push(n),this.col.push(n,1)):n=this.rows[e],n.push(t,i)}},pop:function(t){void 0===t&&(t=this.rows.length-1);var i=this.rows[t],e=i.pop();return 0===i.length()&&s.call(this,t),e},unshift:function(t,i,e){if(!(e<-1)){if(e===this.rows.length)return void this.push(t,i,e);void 0===e&&(e=-1);var n;e===-1?(n=new r({direction:r.DIRECTION.X,spacing:this.options.spacing[0]}),this.rows.unshift(n),this.col.unshift(n,1)):n=this.rows[e],n.unshift(t,i)}},shift:function(t){void 0===t&&(t=0);var i=this.rows[t],e=i.shift();return 0===this.rows[t].length()&&s.call(this,t),e},insertAfter:function(t,i,e,n){var s=this.rows[t];s.insertAfter(i,e,n)},insertBefore:function(t,i,e,n){var s=this.rows[t];s.insertBefore(i,e,n)},unlink:function(t,i){var e=this.rows[t];e.unlink(i)},advance:function(t){var i=t+1,e=this.rows.length,n=this.pop(t);n.remove(),i-=e-this.rows.length;var s=1;this.unshift(n,s,i)},retreat:function(t){var i=t-1,e=this.shift(t);e.remove();var n=1;this.push(e,n,i)},resize:function(t){for(var i=0;i<t.length;i++){for(var e=t[i],n=this.rows[i].nodes.length;n>e;)this.advance(i),n--;for(;n<e;)this.retreat(i+1),n++}}});n.exports=a}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){return this.options.direction===h.DIRECTION.X?o.translateX(t):o.translateY(t)}var o=e(9),r=e(25),a=e(58),u=e(16),h={DIRECTION:{X:0,Y:1}},c=r.extend({defaults:{direction:h.DIRECTION.X,spacing:0,offset:0},initialize:function(t){this.nodes=[],this.stream=new a(function(i,e,n){return!!e&&i+e[t.direction]+n},void 0,{sources:[t.spacing],offset:t.offset}),this.setLengthMap(s);var i=u.lift(function(t,i){return Math.max(t-i,0)},[this.stream.headOutput,t.spacing]);this.output.subscribe(i);var e=[];this.size=u.lift(function(i,n){if(i&&void 0!==n)return e[t.direction]=n,e[1-t.direction]=i[1-t.direction],e},[this._size,i])},setLengthMap:function(t,i){this.transformMap=t.bind(this),i&&this.setSources(i)},setSources:function(t){this.sources=t},push:function(t){this.nodes.push(t);var i=this.stream.push(t.size),e=this.sources?u.lift(this.transformMap,[i].concat(this.sources)):i.map(this.transformMap);this.add({transform:e}).add(t)},pop:function(){return this.unlink(this.nodes.length-1)},unshift:function(t){this.nodes.unshift(t);var i=this.stream.unshift(t.size),e=i.map(this.transformMap);this.add({transform:e}).add(t)},shift:function(){return this.unlink(0)},insertAfter:function(t,i){var e;if("number"==typeof t?(e=t+1,t=this.nodes[t]):e=this.nodes.indexOf(t)+1,this.nodes.splice(e,0,i),!t)return this.push(i);var n=this.stream.insertAfter(t.size,i.size),s=n.map(this.transformMap);this.add({transform:s}).add(i)},insertBefore:function(t,i){var e;if("number"==typeof t?(e=t-1,t=this.nodes[t]):e=this.nodes.indexOf(t)-1,this.nodes.splice(e+1,0,i),!t)return this.unshift(i);var n=this.stream.insertBefore(t.size,i.size),s=n.map(this.transformMap);this.add({transform:s}).add(i)},unlink:function(t){var i;if("number"==typeof t?(i=t,t=this.nodes[t]):i=this.nodes.indexOf(t),t&&t.size)return this.nodes.splice(i,1),this.stream.remove(t.size),t}},h);n.exports=c}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){var s=e(9),o=e(25),r=e(16),a=o.extend({defaults:{header:null,content:null,footer:null},initialize:function(t){this.contentNode=null;var i,e;t.header?(e=t.header.size.map(function(t){return!!t&&s.translateY(t[1])}),i=t.footer?r.lift(function(t,i,e){return!(!t||!i)&&[e[0],e[1]-t[1]-i[1]]},[t.header.size,t.footer.size,this.size]):r.lift(function(t,i){return!(!t||!i)&&[i[0],i[1]-t[1]]},[t.header.size,this.size]),this.add(t.header),this.contentNode=this.add({transform:e,size:i})):t.footer&&(i=r.lift(function(t,i){return!!t&&[i[0],i[1]-t[1]]},[t.footer.size,this.size]),this.contentNode=this.add({size:i})),t.footer&&(e=t.footer.size.map(function(t){return s.translateY(-t[1])}),this.add({align:[0,1],transform:e}).add(t.footer)),t.content&&this.addContent(t.content)},addContent:function(t){this.options.content=t,this.contentNode.add(t)}});n.exports=a}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){t!==this._previousIndex&&(this.emit("page",t),this._previousIndex=t)}function o(t,i){this.drag.halt(),this.spring.reset(t),this.options.edgeTransition.velocity=i,this.spring.set(0,this.options.edgeTransition)}function r(t){var i,e=this.options.pageChangeSpeed,n=this.items[this._currentIndex].getSize()[this.options.direction],s=this.itemOffset,o=this.itemOffset-n,r=this.itemOffset,a=n/2;i=t<0?r>a||t<-e?o:s:r<a||t>e?s:o,this.options.pageTransition.velocity=t,this.spring.halt(),this.spring.reset(-i),this.spring.set(0,this.options.pageTransition)}function a(t){this.drag.halt(),this.drag.reset(0),this.drag.set(0,{curve:"inertia",velocity:t,drag:this.options.drag})}var u=e(9),h=e(11),c=e(25),p=e(16),l=e(56),d=e(55),f=e(60),v=e(38),y=e(44),m=e(48),_=e(46),g=e(45);y.register({touch:_,scroll:m,mouse:g});var b={DIRECTION:{X:0,Y:1}},O={TOP:-1,BOTTOM:1,NONE:0},I=c.extend({defaults:{direction:b.DIRECTION.Y,drag:.3,paginated:!1,pageChangeSpeed:.5,startPosition:0,marginTop:0,marginBottom:0,clip:!0,enableMouseDrag:!1,pageTransition:{curve:"spring",period:100,damping:.8},edgeTransition:{curve:"spring",period:100,damping:1},edgeGrip:.5},initialize:function(t){this._currentIndex=0,this._previousIndex=0,this.itemOffset=0,this.items=[],this.velocity=0,this.overflow=0;var i=!1,e=!1,n=O.NONE;this.layout=new f({direction:t.direction});var c=t.enableMouseDrag?["touch","scroll","mouse"]:["touch","scroll"],m=new y(c,{direction:t.direction}),_=new l(-t.startPosition);this.drag=new h(0),this.spring=new h(0);var g=new d,I=new d,x=m.pluck("delta");g.subscribe(this.drag),I.subscribe(this.spring),_.subscribe(x),_.subscribe(g),_.subscribe(I);var T=m.getInput("scroll");T.on("start",function(){e=!0}),T.on("end",function(){e=!1}),m.on("start",function(){i=!0,this.drag.halt(),this.spring.halt()}.bind(this)),m.on("update",function(t){this.velocity=t.velocity}.bind(this)),m.on("end",function(t){switch(i=!1,n){case O.NONE:this.options.paginated?r.call(this,t.velocity):a.call(this,t.velocity);break;case O.TOP:o.call(this,this.overflow,t.velocity);break;case O.BOTTOM:o.call(this,this.overflow,t.velocity)}}.bind(this)),this.drag.on("update",function(){this.velocity=this.drag.getVelocity()}.bind(this)),this.spring.on("update",function(){this.velocity=this.spring.getVelocity()}.bind(this)),_.on("end",function(){this.spring.isActive()||s.call(this,this._currentIndex)}.bind(this));var w=p.lift(function(i,e){if(!i)return!1;var n=e[t.direction]-t.marginBottom-i;return!(n>=0)&&n},[this.layout,this.size]);this.offset=p.lift(function(t,r){if(!r)return!1;if(this.spring.isActive())return Math.round(t);if(t>0){if(e)return n=O.TOP,_.set(0,!0),s.call(this,this._currentIndex),0;this.overflow=t,n!==O.TOP&&(m.setOptions({scale:this.options.edgeGrip}),n=O.TOP,i||o.call(this,this.overflow,this.velocity))}else if(t<r){if(e)return n=O.BOTTOM,_.set(r,!0),s.call(this,this._currentIndex),r;this.overflow=t-r,n!==O.BOTTOM&&(m.setOptions({scale:.5}),n=O.BOTTOM,i||o.call(this,this.overflow,this.velocity))}else t>r&&t<0&&n!==O.NONE&&(this.overflow=0,m.setOptions({scale:1}),n=O.NONE);return Math.round(t)}.bind(this),[_,w]);var S=this.offset.map(function(i){return i+=t.marginTop,t.direction===b.DIRECTION.Y?u.translateY(i):u.translateX(i)});this.container=new v({properties:{overflow:"hidden"}}),m.subscribe(this.container),this.container.add({transform:S}).add(this.layout),this.add(this.container)},setPerspective:function(){v.prototype.setPerspective.apply(this.container,arguments)},getVelocity:function(){return this.velocity},goTo:function(t,i,e){i=i||this.options.pageTransition;var n,s=this.itemOffset;if(t>this._currentIndex&&t<this.items.length)for(n=this._currentIndex;n<t;n++)s-=this.items[n].getSize()[this.options.direction];else if(t<this._currentIndex&&t>=0)for(n=this._currentIndex;n>t;n--)s+=this.items[n].getSize()[this.options.direction];this.spring.halt(),this.spring.reset(0),this.spring.set(Math.ceil(s),i,e)},getCurrentIndex:function(){return this._currentIndex},addItems:function(t){for(var i=0;i<t.length;i++)this.layout.push(t[i]);this.items=t;var e=[this.offset];for(i=0;i<t.length;i++)e.push(t[i].size);var n=0,s=p.lift(function(){if(void 0===arguments[0]||void 0===arguments[1])return!1;var i=arguments[0],e=this.options.direction,s=this._currentIndex,o=arguments[s+1];if(!o)return!1;var r=0,a=-i-n,u=o[e];return a>=u&&this._currentIndex!==t.length-1?(this._currentIndex++,r=0,n+=u):a<0&&0!==this._currentIndex?(this._currentIndex--,r=1,u=arguments[this._currentIndex+1][e],n-=u):r=a/u,this.itemOffset=a,{index:this._currentIndex,progress:r}}.bind(this),e);this.output.subscribe(s),s.on("start",function(){}),s.on("update",function(){}),s.on("end",function(){})}},b);n.exports=I}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){n.exports={Accumulator:e(56),Differential:e(55),SimpleStream:e(12),Stream:e(16),Observable:e(31)}}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){n.exports={Camera:e(65),TrackballCamera:e(68),Quaternion:e(66),QuatTransitionable:e(67)}}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.options=p.setOptions(this,t),this.orientationState=o.create(t.orietation),this.position=new u(t.position),this.orientation=new r(this.orientationState);var i=l.lift(function(t,i){o.conjugate(i,this.orientationState);var e=o.toTransform(this.orientationState);return a.thenMove(e,t)}.bind(this),[this.position,this.orientation]),e=new h({transform:i});this._node=new c(e)}var o=e(66),r=e(67),a=e(9),u=e(11),h=e(29),c=e(28),p=e(27),l=e(16);s.DEFAULT_OPTIONS={position:[0,0,0],orientation:o.create()},s.prototype.setPosition=function(t,i,e){this.position.set(t,i,e)},s.prototype.getPosition=function(){return this.position.get()},s.prototype.setOrientation=function(t,i,e){o.fromAngleAxis(t,this.orientationState),this.orientation.set(this.orientationState,i,e)},s.prototype.getOrientation=function(){return o.toAngleAxis(this.orientation.get())},s.prototype.zoomBy=function(t,i,e){var n=this.position.get(),s=[n[0],n[1],n[2]+t];this.position.set(s,i,e)},s.prototype.setZoom=function(t,i,e){var n=this.getPosition(),s=n[2],o=t-s;this.zoomBy(o,i,e)},s.prototype.rotateBy=function(t,i,e){var n=this.orientation.get();o.multiply(n,t,this.orientationState),this.orientation.set(this.orientationState,i,e)},s.prototype.translateBy=function(t,i,e){var n=this.position.get(),s=[n[0]+t[0],n[1]+t[1],n[2]+t[2]];this.position.set(s,i,e)},s.prototype.lookAt=function(t,i,e){var n=a.interpret(t),s=n.rotate;o.fromEulerAngles(s,this.orientationState),o.conjugate(this.orientationState,this.orientationState),this.orientation.set(this.orientationState,i)},s.prototype._onAdd=function(t){return t.add(this._node)},s.prototype.add=function(){return c.prototype.add.apply(this._node,arguments)},s.prototype.remove=function(){return c.prototype.remove.apply(this._node,arguments)},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,e){var n=[1,0,0,0],s={};s.create=function(t){return(t||n).slice()},s.set=function(t,i){i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3]},s.fromAngleAxis=function(t,i){var e=t[0],n=t[1],s=t[2],o=t[3],r=Math.hypot(n,s,o);if(0===r)i[0]=1,i[1]=i[2]=i[3]=0;else{var a=.5*e,u=Math.sin(a)/r;i[0]=Math.cos(a),i[1]=u*n,i[2]=u*s,i[3]=u*o}},s.fromEulerAngles=function(t,i){var e=.5*t[0],n=.5*t[1],s=.5*t[2],o=Math.sin(e),r=Math.sin(n),a=Math.sin(s),u=Math.cos(e),h=Math.cos(n),c=Math.cos(s);i[0]=u*h*c-o*r*a,i[1]=o*h*c+u*r*a,i[2]=u*r*c-o*h*a,i[3]=u*h*a+o*r*c},s.sum=function(t,i,e){e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3]},s.multiply=function(t,i,e){var n=t[0],s=t[1],o=t[2],r=t[3],a=i[0],u=i[1],h=i[2],c=i[3];e[0]=n*a-s*u-o*h-r*c,e[1]=s*a+u*n+h*r-o*c,e[2]=o*a+h*n+s*c-u*r,e[3]=r*a+c*n+u*o-s*h},s.scalarMultiply=function(t,i,e){e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=i*t[3]},s.conjugate=function(t,i){i[0]=t[0],i[1]=-t[1],i[2]=-t[2],i[3]=-t[3]},s.negate=function(t,i){i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i[3]=-t[3]},s.normalize=function(t,i){var e=s.length(t);s.scalarMultiply(t,1/e,i)},s.slerp=function(t,i,e,n){if(0===e)s.set(t,n);else if(1===e)s.set(i,n);else{var o,r,a=s.dot(t,i);if(a<1){var u=Math.acos(a),h=Math.sin(u);o=Math.sin((1-e)*u)/h,r=Math.sin(e*u)/h}else o=1-e,r=e;var c=[],p=[];s.scalarMultiply(t,o,c),s.scalarMultiply(i,r,p),s.sum(c,p,n)}},s.length=function(t){return Math.hypot.apply(null,t)},s.dot=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]+t[3]*i[3]},s.toTransform=function(t){var i=t[0],e=t[1],n=t[2],s=t[3],o=e*e,r=n*n,a=s*s,u=e*n,h=e*s,c=n*s,p=i*e,l=i*n,d=i*s;return[1-2*(r+a),2*(u-d),2*(h+l),0,2*(u+d),1-2*(o+a),2*(c-p),0,2*(h-l),2*(c+p),1-2*(o+r),0,0,0,0,1]},s.toEulerAngles=function(t){var i=t[0],e=t[1],n=t[2],s=t[3],o=e*e,r=n*n,a=s*s,u=2*(e*s+n*i);return u=u<-1?-1:u>1?1:u,[Math.atan2(2*(e*i-n*s),1-2*(o+r)),Math.asin(u),Math.atan2(2*(s*i-e*n),1-2*(r+a))]},s.toAngleAxis=function(t){var i=s.length(t),e=Math.acos(t[0]);if(0===e)return[0,1,0,0];var n=i/Math.sin(e),o=2*e,r=n*t[1],a=n*t[2],u=n*t[3];return[o,r,a,u]},s.getAngle=function(t){return 2*Math.acos(t[0])},s.getAxis=function(t){var i=s.length(t),e=Math.acos(t[0]);if(0===e)return[1,0,0];var n=i/Math.sin(e),o=n*t[1],r=n*t[2],a=n*t[3];return[o,r,a]},s.setAngle=function(t,i,e){var n=s.getAxis(t);n.unshift(i),s.fromAngleAxis(n,e)},s.rotateVector=function(t,i){var e=[],n=[0,i[0],i[1],i[2]];return s.conjugate(t,e),s.multiply(e,n,e),s.multiply(e,t,e),e.shift(),e},e.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){this.start=o.create(),this.end=o.create(),this.value=o.create(),this.t=new r(0),this._eventOutput=this.t.map(function(t){return o.slerp(this.start,this.end,t,this.value),this.value}.bind(this)),u.setOutputHandler(this,this._eventOutput)}var o=e(66),r=e(11),a=e(12),u=e(3);s.prototype=Object.create(a.prototype),s.prototype.constructor=s,s.prototype.set=function(t,i,e){o.set(this.get(),this.start),o.dot(this.start,t)<0&&o.negate(this.start,this.start),o.set(t,this.end),this.t.reset(0),this.t.set(1,i,e)},s.prototype.reset=function(t,i){o.set(t,this.start),r.prototype.getVelocity.call(this.t,0)},s.prototype.isActive=function(){return r.prototype.isActive.apply(this.t,arguments)},s.prototype.halt=function(){o.set(this.get(),this.value),r.prototype.halt.apply(this.t,arguments)},s.prototype.get=function(){return this.value},s.prototype.getVelocity=function(){return r.prototype.getVelocity.apply(this.t,arguments)},n.exports=s}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))},function(t,i,e){var n;n=function(t,i,n){function s(t){var i=t.delta,e=i[0],n=i[1],s=t.x-this.center[0],o=t.y-this.center[1],r=this.options.radius,a=s+e,u=o+n,h=this.options.radius,c=1/Math.hypot(s,o,r),p=1/Math.hypot(a,u,h);s*=c,o*=c,r*=c,a*=p,u*=p,h*=p;var l=Math.acos(s*a+o*u+r*h),d=o*h-r*u,f=r*a-s*h,v=s*u-o*a;return[l,d,f,v]}var o=e(65),r=e(66),a=e(26),u=e(9),h=e(11),c=e(16),p=e(45),l=e(46),d=e(48),f=e(52),v=e(44);
v.register({mouse:p,touch:l,pinch:f,scroll:d});var y=a.extend({defaults:{radius:500,rotationScale:1,zoomScale:1,inertia:!0,position:o.DEFAULT_OPTIONS.position,orientation:o.DEFAULT_OPTIONS.orientation},initialize:function(t){this.camera=new o(t),this.delta=r.create(),this.orientation=this.camera.orientation,this.position=this.camera.position,this.center=[];var i=c.lift(function(t,i){if(!t||!i)return!1;var e=u.getTranslate(i.transform);this.center[0]=e[0]+.5*t[0],this.center[1]=e[1]+.5*t[1]}.bind(this),[this.camera._node._size,this.camera._node.layout]);i.on("start",function(t){}),i.on("update",function(t){}),i.on("end",function(t){});var e=!!t.inertia&&new h(0),n=!!t.inertia&&new h(0),a=new v(["mouse","touch"],{scale:t.rotationScale,limit:1}),p=new v({pinch:{scale:t.zoomScale},scroll:{scale:t.zoomScale,direction:d.DIRECTION.Y}});a.subscribe(this.input),p.subscribe(this.input);var l=!1;a.on("start",function(t){l=!1,e&&e.isActive()&&e.halt(),this.emit("start",{position:this.getPosition(),orientation:this.getOrientation()})}.bind(this)),a.on("update",function(t){l=!0;var i=s.call(this,t);r.fromAngleAxis(i,this.delta),this.rotateBy(this.delta),this.emit("update",{position:this.getPosition(),orientation:this.getOrientation()})}.bind(this)),a.on("end",function(t){if(l&&e){var i=r.getAngle(this.delta);e.reset(i),e.set(i,{curve:"damp",damping:.9})}else this.emit("end",{position:this.getPosition(),orientation:this.getOrientation()})}.bind(this)),e&&(e.on("update",function(t){r.setAngle(this.delta,t,this.delta),this.rotateBy(this.delta),this.emit("update",{position:this.getPosition(),orientation:this.getOrientation()})}.bind(this)),e.on("end",function(t){this.emit("end",{position:this.getPosition(),orientation:this.getOrientation()})}.bind(this))),p.on("update",function(t){var i=t.delta;this.zoomBy(i),this.emit("update",{position:this.getPosition(),orientation:this.getOrientation()})}.bind(this)),p.on("end",function(t){if(n&&0!==t.velocity){var i=this.getPosition()[2];n.reset(i),n.set(i,{curve:"inertia",damping:.2,velocity:t.velocity})}else this.emit("end",{position:this.getPosition(),orientation:this.getOrientation()})}.bind(this)),n&&(n.on("update",function(t){this.setZoom(t),this.emit("update",{position:this.getPosition(),orientation:this.getOrientation()})}.bind(this)),n.on("end",function(t){this.emit("end",{position:this.getPosition(),orientation:this.getOrientation()})}.bind(this)))},_onAdd:function(){return o.prototype._onAdd.apply(this.camera,arguments)},add:function(){return o.prototype.add.apply(this.camera,arguments)},remove:function(){return o.prototype.remove.apply(this.camera,arguments)},setPosition:function(t,i,e){o.prototype.setPosition.apply(this.camera,arguments)},getPosition:function(){return o.prototype.getPosition.apply(this.camera)},setOrientation:function(t,i,e){o.prototype.setOrientation.apply(this.camera,arguments)},getOrientation:function(){return o.prototype.getOrientation.apply(this.camera)},zoomBy:function(t,i,e){o.prototype.zoomBy.apply(this.camera,arguments)},setZoom:function(t,i,e){o.prototype.setZoom.apply(this.camera,arguments)},rotateBy:function(t,i,e){o.prototype.rotateBy.apply(this.camera,arguments)},lookAt:function(t,i,e){o.prototype.lookAt.apply(this.camera,arguments)}});n.exports=y}.call(i,e,i,t),!(void 0!==n&&(t.exports=n))}])});